<!DOCTYPE html>
<html lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"stellarkey.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"P1TCRNQBR7","apiKey":"501e087ded257acc9dc481944c14c248","indexName":"云端","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="北斗计划 - 天枢。A little bit of recordings during the UMA session.">
<meta property="og:type" content="article">
<meta property="og:title" content="北斗UMA专项">
<meta property="og:url" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/index.html">
<meta property="og:site_name" content="思维之海">
<meta property="og:description" content="北斗计划 - 天枢。A little bit of recordings during the UMA session.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008155242161.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008160811087.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008160954105.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/ds_subpage_diagram2.svg">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007193146928.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007193507875.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007194413669.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007195754366.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007195720862.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007200959708.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007202822926.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007210215805.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007210512219.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007210854052.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007211228922.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007234130612.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008002548277.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008002946068.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008003136978.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008004353768.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008004514650.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008022034530.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008110908510.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008114435446.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008014307350.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008013717131.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008004632381.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008004932339.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008005312172.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008005449147.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008010009472.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008010347232.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008011005416.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008011130430.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008011846655.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008012202607.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201015193226448.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201015200907786.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201015212005851.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201015235330134.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016000956618.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016001705433.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016001609824.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016002315094.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016002453805.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016002721904.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016120636955.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016120734072.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016122836503.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016122857302.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016122729183.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016123108333.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016133242321.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016133717044.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016133747376.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106231734404.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106221649667.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106223136829.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106231645734.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234806332.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106231922911.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106233822291.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234706086.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106233800792.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234728598.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234113850.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234137147.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234418328.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234505423.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234544548.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234615735.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234306249.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000207723.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000248108.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000336701.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000714298.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000727118.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000610545.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000640270.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107001116958.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107014651439.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015032551.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015144464.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015159377.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015306819.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015323150.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015430139.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015526840.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015510016.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015647940.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015705803.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015720588.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015925069.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107020002607.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107020116644.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107020132737.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107022334908.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107022434198.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201109225608055.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110221640108.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110223816308.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110233817335.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110233941247.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234019028.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234106465.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234242002.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234301936.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234445503.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111001414466.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111001212392.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111181900247.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111182622153.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111182715084.png">
<meta property="og:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111182857195.png">
<meta property="article:published_time" content="2020-10-07T10:39:06.000Z">
<meta property="article:modified_time" content="2022-05-26T07:48:15.028Z">
<meta property="article:author" content="工云">
<meta property="article:tag" content="区块链">
<meta property="article:tag" content="Conflux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008155242161.png">

<link rel="canonical" href="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>北斗UMA专项 | 思维之海</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <script async defer data-website-id="d07df043-7587-49c8-bc01-ac5ebfdafee5" src="https://stellarkey.asia/umami.js"></script>
<link rel="alternate" href="/atom.xml" title="思维之海" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">思维之海</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">——在云端，寻找我的星匙。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fas fa-anchor fa-fw"></i> </a>

  </li>
        <li class="menu-item menu-item-life">

    <a href="https://vel.life/" rel="noopener external nofollow noreferrer" target="_blank"><i class="fas fa-star-of-life fa-fw"></i> </a>

  </li>
        <li class="menu-item menu-item-wiki">

    <a href="https://vel.wiki/" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-wikipedia-w fa-fw"></i> </a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fas fa-th fa-fw"></i> </a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fas fa-tags fa-fw"></i> </a>

  </li>
        <li class="menu-item menu-item-link">

    <a href="/link/" rel="section"><i class="fas fa-link fa-fw"></i> </a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fas fa-user fa-fw"></i> </a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

    
    

    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/stellarkey.gif">
      <meta itemprop="name" content="工云">
      <meta itemprop="description" content="Never stop thinking.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="思维之海">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          北斗UMA专项
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Learn/" itemprop="url" rel="index"><span itemprop="name">Learn</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.edu.confluxnetwork.org/"><strong>北斗计划 - 天枢</strong></a>。A little bit of recordings during the UMA session.<span id="more"></span></p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://confluxnetwork.org/">Conflux</a></p>
<blockquote>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.edu.confluxnetwork.org/%E8%AF%BE%E7%A8%8B">Conflux课程视频</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.conflux.fun">forum.conflux.fun</a> Conflux Forum，Homework &amp; Resources</p>
</blockquote>
<h1 id="Lecture-1-Introduction-Of-Blockchain"><a href="#Lecture-1-Introduction-Of-Blockchain" class="headerlink" title="Lecture 1 - Introduction Of Blockchain"></a>Lecture 1 - Introduction Of Blockchain</h1><blockquote>
<p>This part is the same as <a href="https://stellarkey.github.io/%E5%8C%BA%E5%9D%97%E9%93%BE/">https://stellarkey.github.io/区块链</a>.</p>
</blockquote>
<h1 id="Lecture-2-Cryptoeconomics-加密经济学"><a href="#Lecture-2-Cryptoeconomics-加密经济学" class="headerlink" title="Lecture 2 - Cryptoeconomics 加密经济学"></a>Lecture 2 - Cryptoeconomics 加密经济学</h1><blockquote>
<p><em>winner takes all</em></p>
</blockquote>
<p>Blockchains and cryptocurrency will generate a new and better internet.</p>
<h2 id="Token-通证"><a href="#Token-通证" class="headerlink" title="Token 通证"></a>Token 通证</h2><blockquote>
<p>SoV: Store of Value; MoE: Media of Exchange.</p>
<p>NFTs: non-fungible tokens（非同质化通证），代表特定数字资产的特殊通证</p>
<p>DeFi: 一类携带投票权的token</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008155242161.png" class="" title="Types of Tokens">
<h3 id="Token-Design"><a href="#Token-Design" class="headerlink" title="Token Design"></a>Token Design</h3><img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008160811087.png" class="" title="Multi Disciplinary Approach">
<h3 id="3-D’s-of-Token-Design"><a href="#3-D’s-of-Token-Design" class="headerlink" title="3 D’s of Token Design"></a>3 D’s of Token Design</h3><img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008160954105.png" class="" width="3" title="D" alt="s of Token Design">
<h2 id="Conflux-Token-Economy-通证经济"><a href="#Conflux-Token-Economy-通证经济" class="headerlink" title="Conflux Token Economy 通证经济"></a>Conflux Token Economy 通证经济</h2><p>The cryptoeconomic goals for Conflux were to:<br>● Attract users to actively use the network for value add services, and global ventures.<br>● Remove any barriers to entry for those making meaningful contributions<br>● Support security, stability, and predictability of the network</p>
<h3 id="Key-problem"><a href="#Key-problem" class="headerlink" title="Key problem"></a>Key problem</h3><ul>
<li><strong>Inefficient On-Chain Storage</strong><br>● Ethereum users pay a one time fee at the time of including the code on chain, but the community bears the cost of keeping the contract in storage - much of the state-tree space on Ethereum is occupied by inactive smart contracts.</li>
<li><strong>Wasted Computation</strong><br>● BTC and ETH process blocks strictly one-by-one, creating a winner takes all characteristic for mining these chains, increasing the chance of forks.</li>
<li><strong>Low Throughput</strong><br>● Many PoW chains have a low TPS, and not suitable for payments.</li>
</ul>
<h3 id="Conflux-Token-CFX"><a href="#Conflux-Token-CFX" class="headerlink" title="Conflux Token (CFX)"></a>Conflux Token (CFX)</h3><p>Conflux’s unique native token is called CFX which is used for economic value transfers and payments for the cost of usage.</p>
<p>CFX was designed to serve as a:</p>
<ul>
<li>Medium of Exchange (<strong>MoE</strong>)</li>
<li>Store of Value (<strong>SoV</strong>)</li>
<li>A unit of account for blockchain based data</li>
<li>Miner Incentives (compensation for processing new blocks)</li>
</ul>
<p>CFX exists in two forms: <strong>Liquid</strong> and <strong>illiquid</strong>.</p>
<ul>
<li><strong>Liquid</strong>: they can be immediately transferred/used on Conflux<br>Network.</li>
<li><strong>Illiquid</strong>: Tokens are locked up (via staking) in three different forms:<br>1) Staked to earn the user interest<br>2) Bonded storage to purchase space on the network<br>3) Locked up to purchase votes in network governance</li>
</ul>
<h3 id="Staking-权益制"><a href="#Staking-权益制" class="headerlink" title="Staking 权益制"></a>Staking 权益制</h3><h4 id="Staking-for-Interest-利息"><a href="#Staking-for-Interest-利息" class="headerlink" title="Staking for Interest 利息"></a>Staking for Interest 利息</h4><p>Conflux Network distributes interest on all tokens at a rate of 4% per year.</p>
<h4 id="Staking-for-Storage-Space-存储"><a href="#Staking-for-Storage-Space-存储" class="headerlink" title="Staking for Storage Space 存储"></a>Staking for Storage Space 存储</h4><p>A user who wants to use Conflux Network for smart contract execution needs to place a pre-defined number of tokens into a bonded storage.</p>
<script type="math/tex; mode=display">
1\; \text{CFX} = 1\; \text{kb}</script><h4 id="Staking-for-Voting-Rights-投票权"><a href="#Staking-for-Voting-Rights-投票权" class="headerlink" title="Staking for Voting Rights 投票权"></a>Staking for Voting Rights 投票权</h4><p>Conflux Network’s ecosystem fund in the future will transform into a DAO where Conflux stakeholders vote on operations using voting rights.</p>
<p>To cast a vote, users must lock up their tokens, where the time locked up determines the number of votes. Voting rights awarded according to:</p>
<script type="math/tex; mode=display">
\text{Votes} = \text{Number of quarters} \times \text{number of tokens} \times 0.25</script><h3 id="Mining-Rewards-挖矿奖励"><a href="#Mining-Rewards-挖矿奖励" class="headerlink" title="Mining Rewards 挖矿奖励"></a>Mining Rewards 挖矿奖励</h3><p>Miners receive income from three sources:</p>
<ul>
<li><strong>Transaction User Fees</strong>: In the long term user fees will make the majority of miner income</li>
<li><strong>Block Rewards</strong>: In the short term, block rewards will make the majority of miner income.</li>
<li><strong>Interest Income</strong>: Interest on bonded storage tokens are given to miners.</li>
</ul>
<h3 id="Economy-System"><a href="#Economy-System" class="headerlink" title="Economy System"></a>Economy System</h3><blockquote>
<p>Adjust Miner revenue as function of adoption.</p>
</blockquote>
<p>Real application is not living in a vacuum, but a complex and random world. That means we have to introduce some random mechanisms into the model.</p>
<h1 id="Lecture-3-Fundamental-Concepts-amp-Tools"><a href="#Lecture-3-Fundamental-Concepts-amp-Tools" class="headerlink" title="Lecture 3 - Fundamental Concepts &amp; Tools"></a>Lecture 3 - Fundamental Concepts &amp; Tools</h1><blockquote>
<p><em>从用户的角度理解区块链。</em></p>
</blockquote>
<h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><ul>
<li>Conflux Portal (wallet)  ▸ <a target="_blank" rel="noopener external nofollow noreferrer" href="https://portal.conflux-chain.org">portal.conflux-chain.org</a></li>
<li>Conflux Scan (block chain explorer)  ▸ <a target="_blank" rel="noopener external nofollow noreferrer" href="https://confluxscan.io">confluxscan.io</a></li>
<li>Conflux Studio (IDE)  ▸ <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ObsidianLabs/ConfluxStudio">github.com/ObsidianLabs/ConfluxStudio</a></li>
<li>js-conflux-sdk (Node.js SDK)  ▸ <a target="_blank" rel="noopener external nofollow noreferrer" href="https://npmjs.com/package/js-conflux-sdk">npmjs.com/package/js-conflux-sdk</a></li>
<li>Discord  ▸ <a target="_blank" rel="noopener external nofollow noreferrer" href="https://discord.com/invite/aCZkf2C">discord.com/invite/aCZkf2C</a></li>
<li>Conflux Forum  ▸ <a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.conflux.fun">forum.conflux.fun</a></li>
</ul>
<h2 id="Accounts-amp-Transactions-账户和交易"><a href="#Accounts-amp-Transactions-账户和交易" class="headerlink" title="Accounts &amp; Transactions 账户和交易"></a>Accounts &amp; Transactions 账户和交易</h2><h3 id="Digital-signatures-数字签名"><a href="#Digital-signatures-数字签名" class="headerlink" title="Digital signatures 数字签名"></a>Digital signatures 数字签名</h3><p><strong>digital signatures</strong> are cryptographic tools and algorithms used to prove message authenticity and integrity</p>
<ul>
<li><strong><font color=blue>authenticity</font></strong>（真实性）: the sender is who they claim to be</li>
<li><strong><font color=blue>integrity</font></strong>（完整性）: the message has not been modified</li>
</ul>
<blockquote>
<p>大多数区块链系统使用椭圆曲线密码学，即<strong>椭圆曲线数字签名算法</strong>（<strong><font color=red>ECDSA</font></strong>）。【非对称加密】</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/ds_subpage_diagram2.svg" class="" title="https:&#x2F;&#x2F;www.docusign.com&#x2F;how-it-works&#x2F;electronic-signature&#x2F;digital-signature&#x2F;digital-signature-faq">
<h4 id="Wallets"><a href="#Wallets" class="headerlink" title="Wallets"></a>Wallets</h4><p>Your <strong><font color=red>identity</font></strong> is: your <strong><font color=red>private-public keypair</font></strong></p>
<blockquote>
<p>钱包就是一个存储 identity 的容器。</p>
</blockquote>
<h3 id="js-conflux-sdk"><a href="#js-conflux-sdk" class="headerlink" title="js-conflux-sdk"></a><code>js-conflux-sdk</code></h3><blockquote>
<p>read and run the full example</p>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://gist.github.com/Thegaram/0652c8e359f73b1772311c8ed34a32c0">https://gist.github.com/Thegaram/0652c8e359f73b1772311c8ed34a32c0</a></li>
</ul>
<p>js-conflux-sdk documentation</p>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.npmjs.com/package/js-conflux-sdk/v/1.0.0-alpha.4">https://www.npmjs.com/package/js-conflux-sdk/v/1.0.0-alpha.4</a></li>
</ul>
</blockquote>
<p>Using the upfront 3 lines to install <code>js-conflux-sdk@1.0.0-alpha.4</code>（注意版本）。</p>
<blockquote>
<p>Or if you have installed a WSL like me…</p>
<blockquote>
<p>Newer version might have different actions.</p>
</blockquote>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> conflux-playground</span><br><span class="line">$ <span class="built_in">cd</span> conflux-playground</span><br><span class="line">$ npm install js-conflux-sdk@1.0.0-alpha.4</span><br><span class="line">$ node   <span class="comment"># enter coding mode</span></span><br></pre></td></tr></table></figure>
<h3 id="Key-amp-Address-Coding-practice"><a href="#Key-amp-Address-Coding-practice" class="headerlink" title="Key &amp; Address - Coding practice"></a>Key &amp; Address - Coding practice</h3><img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007193146928.png" class="" title="the process">
<blockquote>
<p>This process is nearly impossible to do it backwards.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// import &quot;js-conflux-sdk&quot;</span></span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;js-conflux-sdk/src/util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// generate a random private key</span></span><br><span class="line"><span class="keyword">const</span> privkey = util.<span class="property">sign</span>.<span class="title function_">randomPrivateKey</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;private key:&#x27;</span>, util.<span class="property">format</span>.<span class="title function_">hex</span>(privkey));</span><br><span class="line"></span><br><span class="line"><span class="comment">// derive public key from private key</span></span><br><span class="line"><span class="keyword">const</span> pubkey = util.<span class="property">sign</span>.<span class="title function_">privateKeyToPublicKey</span>(privkey);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;public key:&#x27;</span>, util.<span class="property">format</span>.<span class="title function_">hex</span>(pubkey));</span><br><span class="line"></span><br><span class="line"><span class="comment">// derive address from public key</span></span><br><span class="line"><span class="keyword">const</span> address = util.<span class="property">sign</span>.<span class="title function_">publicKeyToAddress</span>(pubkey);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;address:&#x27;</span>, util.<span class="property">format</span>.<span class="title function_">hex</span>(address));</span><br></pre></td></tr></table></figure>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007193507875.png" class="" title="coding reproduction">
<h4 id="sign-a-message-using-our-private-key"><a href="#sign-a-message-using-our-private-key" class="headerlink" title="sign a message using our private key"></a>sign a message using our private key</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Message</span> = <span class="built_in">require</span>(<span class="string">&#x27;js-conflux-sdk/src/message&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> msg = <span class="keyword">new</span> <span class="title class_">Message</span>(<span class="string">&quot;Hello! Sincerely, Vel&quot;</span>);</span><br><span class="line">msg.<span class="title function_">sign</span>(privkey);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;signed message:&#x27;</span>, msg)</span><br></pre></td></tr></table></figure>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007194413669.png" class="" title="coding reproduction">
<h4 id="check-message-authenticity"><a href="#check-message-authenticity" class="headerlink" title="check message authenticity"></a>check message authenticity</h4><blockquote>
<p>检查信息是否被修改。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const Message = require(&#x27;js-conflux-sdk/src/message&#x27;);</span></span><br><span class="line"><span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> recovered = <span class="title class_">Message</span>.<span class="title function_">recover</span>(msg.<span class="property">signature</span>, msg.<span class="property">hash</span>)</span><br><span class="line">assert.<span class="title function_">equal</span>(recovered, util.<span class="property">format</span>.<span class="title function_">hex</span>(pubkey))</span><br></pre></td></tr></table></figure>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007195754366.png" class="" title="coding reproduction">
<h4 id="tamper-with-message"><a href="#tamper-with-message" class="headerlink" title="tamper with message"></a>tamper with message</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;message:&#x27;</span>, msg.<span class="property">message</span>);</span><br><span class="line">msg.<span class="property">message</span> = <span class="string">&quot;Hello! Sincerely, ----- Hacker&quot;</span>;</span><br><span class="line">recovered = <span class="title class_">Message</span>.<span class="title function_">recover</span>(msg.<span class="property">signature</span>, msg.<span class="property">hash</span>)</span><br><span class="line">assert.<span class="title function_">notEqual</span>(recovered, util.<span class="property">format</span>.<span class="title function_">hex</span>(pubkey))</span><br></pre></td></tr></table></figure>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007195720862.png" class="" title="coding reproduction">
<h4 id="full-example"><a href="#full-example" class="headerlink" title="full example"></a>full example</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Account</span> = <span class="built_in">require</span>(<span class="string">&#x27;js-conflux-sdk/src/account&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Conflux</span>, <span class="title class_">Drip</span>, <span class="title class_">Message</span>, util &#125; = <span class="built_in">require</span>(<span class="string">&#x27;js-conflux-sdk&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ---- generate random private key ----</span></span><br><span class="line">    <span class="keyword">const</span> privkey = util.<span class="property">sign</span>.<span class="title function_">randomPrivateKey</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;private key:&#x27;</span>, util.<span class="property">format</span>.<span class="title function_">hex</span>(privkey));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ---- derive public key ----</span></span><br><span class="line">    <span class="keyword">const</span> pubkey = util.<span class="property">sign</span>.<span class="title function_">privateKeyToPublicKey</span>(privkey);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;public key:&#x27;</span>, util.<span class="property">format</span>.<span class="title function_">hex</span>(pubkey));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ---- derive address ----</span></span><br><span class="line">    <span class="keyword">const</span> address = util.<span class="property">sign</span>.<span class="title function_">publicKeyToAddress</span>(pubkey);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;address:&#x27;</span>, util.<span class="property">format</span>.<span class="title function_">hex</span>(address));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ---- sign message ----</span></span><br><span class="line">    <span class="keyword">const</span> msg = <span class="keyword">new</span> <span class="title class_">Message</span>(<span class="string">&#x27;Hello! Sincerely, Peter&#x27;</span>);</span><br><span class="line">    msg.<span class="title function_">sign</span>(privkey);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;signed message:&#x27;</span>, msg)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ---- check signature ----</span></span><br><span class="line">    <span class="keyword">let</span> recovered = <span class="title class_">Message</span>.<span class="title function_">recover</span>(msg.<span class="property">signature</span>, msg.<span class="property">hash</span>)</span><br><span class="line">    assert.<span class="title function_">strictEqual</span>(recovered, util.<span class="property">format</span>.<span class="title function_">hex</span>(pubkey))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ---- detect tampering using signature ----</span></span><br><span class="line">    msg.<span class="property">message</span> = <span class="string">&#x27;Hello! Sincerely, ----- Hacker&#x27;</span>;</span><br><span class="line">    recovered = <span class="title class_">Message</span>.<span class="title function_">recover</span>(msg.<span class="property">signature</span>, msg.<span class="property">hash</span>)</span><br><span class="line">    assert.<span class="title function_">notStrictEqual</span>(recovered, util.<span class="property">format</span>.<span class="title function_">hex</span>(pubkey))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ---- create and sign transaction ----</span></span><br><span class="line">    <span class="keyword">const</span> local_account = <span class="keyword">new</span> <span class="title class_">Account</span>(&#123; <span class="attr">privateKey</span>: util.<span class="property">format</span>.<span class="title function_">hex</span>(privkey) &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> tx = local_account.<span class="title function_">signTransaction</span>(&#123;</span><br><span class="line">        <span class="attr">from</span>: util.<span class="property">format</span>.<span class="title function_">hex</span>(address),</span><br><span class="line">        <span class="attr">to</span>: util.<span class="property">format</span>.<span class="title function_">hex</span>(address),</span><br><span class="line">        <span class="attr">value</span>: <span class="title class_">Drip</span>.<span class="title function_">fromCFX</span>(<span class="number">10</span>).<span class="title function_">toDrip</span>(),</span><br><span class="line">        <span class="attr">nonce</span>: <span class="string">&#x27;0x00&#x27;</span>,</span><br><span class="line">        <span class="attr">gasPrice</span>: <span class="string">&#x27;0x00&#x27;</span>,</span><br><span class="line">        <span class="attr">gas</span>: <span class="string">&#x27;0x00&#x27;</span>,</span><br><span class="line">        <span class="attr">storageLimit</span>: <span class="string">&#x27;0x00&#x27;</span>,</span><br><span class="line">        <span class="attr">epochHeight</span>: <span class="string">&#x27;0x00&#x27;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;transaction:&#x27;</span>, tx);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;transaction hash:&#x27;</span>, tx.<span class="property">hash</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ---- send transaction ----</span></span><br><span class="line">    <span class="keyword">const</span> conflux = <span class="keyword">new</span> <span class="title class_">Conflux</span>(&#123; <span class="attr">url</span>: <span class="string">&#x27;http://mainnet-jsonrpc.conflux-chain.org:12537&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> import your Conflux Portal wallet</span></span><br><span class="line">    <span class="comment">// follow: Account Details, Export Private Key</span></span><br><span class="line">    <span class="comment">// make sure to add a &#x27;0x&#x27; prefix to your private key</span></span><br><span class="line">    <span class="comment">// make sure your account has sufficient balance</span></span><br><span class="line">    <span class="keyword">const</span> account = conflux.<span class="title class_">Account</span>(&#123; <span class="attr">privateKey</span>: util.<span class="property">format</span>.<span class="title function_">hex</span>(privkey) &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set recipient</span></span><br><span class="line">    <span class="keyword">const</span> to = <span class="string">&#x27;0x145834072064DcD9B931237B5aEe217c241e3644&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set value to send</span></span><br><span class="line">    <span class="keyword">const</span> value = <span class="title class_">Drip</span>.<span class="title function_">fromCFX</span>(<span class="number">10</span>).<span class="title function_">toDrip</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> epochHeight = <span class="keyword">await</span> conflux.<span class="title function_">getEpochNumber</span>();</span><br><span class="line">    <span class="keyword">const</span> estimate = <span class="keyword">await</span> conflux.<span class="title function_">estimateGasAndCollateral</span>(&#123; to, value &#125;);</span><br><span class="line">    <span class="keyword">const</span> gasPrice = <span class="keyword">await</span> conflux.<span class="title function_">getGasPrice</span>();</span><br><span class="line">    <span class="keyword">const</span> nonce = <span class="keyword">await</span> conflux.<span class="title function_">getNextNonce</span>(account.<span class="property">address</span>);</span><br><span class="line">    <span class="keyword">const</span> status = <span class="keyword">await</span> conflux.<span class="title function_">getStatus</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> txHash = <span class="keyword">await</span> account.<span class="title function_">sendTransaction</span>(&#123;</span><br><span class="line">        to,</span><br><span class="line">        value,</span><br><span class="line">        nonce,</span><br><span class="line">        gasPrice,</span><br><span class="line">        <span class="attr">gas</span>: estimate.<span class="property">gasUsed</span>,</span><br><span class="line">        <span class="attr">storageLimit</span>: estimate.<span class="property">storageCollateralized</span>,</span><br><span class="line">        <span class="attr">chainId</span>: status.<span class="property">chainId</span>,</span><br><span class="line">        <span class="attr">data</span>: <span class="literal">null</span>,</span><br><span class="line">        epochHeight,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sending transaction, hash:&#x27;</span>, txHash);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// wait 10 seconds</span></span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">10</span> * <span class="number">1000</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get transaction</span></span><br><span class="line">    <span class="keyword">const</span> transaction = <span class="keyword">await</span> conflux.<span class="title function_">getTransactionByHash</span>(txHash);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;transaction:&#x27;</span>, transaction);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// wait 10 seconds</span></span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">10</span> * <span class="number">1000</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get receipt</span></span><br><span class="line">    <span class="keyword">const</span> receipt = <span class="keyword">await</span> conflux.<span class="title function_">getTransactionReceipt</span>(txHash);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;receipt&#x27;</span>, receipt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>
<h3 id="Account"><a href="#Account" class="headerlink" title="Account"></a>Account</h3><img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007200959708.png" class="" title="Account">
<p>▸for each <strong>identity</strong>, there is a <strong>corresponding account</strong> maintained on the blockchain<br>▸the account <strong>captures a state at a given time</strong>: the current balance, the number of transactions sent, code, …<br>▸your <strong>address</strong> will not change (though you might have multiple addresses)<br>▸the <strong>account state</strong> associated to your address will change as you send and receive transactions</p>
<hr>
<p><strong><font color=blue>JSON-representation of a new account</font></strong>:</p>
<blockquote>
<p>see: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://developer.conflux-chain.org/docs/conflux-doc/docs/json_rpc/#cfx_getaccount">https://developer.conflux-chain.org/docs/conflux-doc/docs/json_rpc/#cfx_getaccount</a></p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;accumulatedInterestReturn&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;admin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x0000000000000000000000000000000000000000&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;balance&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;codeHash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;collateralForStorage&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nonce&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;stakingBalance&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x0&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>each account has a <strong><font color=red>balance</font></strong>(CFX余额) associated with it.</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007202822926.png" class="" title="balance denominations">
<p><strong><font color=red>nonce</font></strong>(交易数): number of accepted transactions from this account</p>
<blockquote>
<p>SIMPLE PAYMENT TRANSACTIONS:</p>
<ul>
<li>simply sending a number of <strong>coins</strong> (tokens) from one address to another</li>
<li>the sender <strong>signs</strong> the transaction using their private key</li>
<li>if you do not have my private key, you cannot send on my behalf</li>
</ul>
</blockquote>
<h3 id="Transaction"><a href="#Transaction" class="headerlink" title="Transaction"></a>Transaction</h3><p><strong><font color=blue>JSON-representation of a transaction</font></strong>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x1dBDA5dD2e952914bC74a802510D0FA59F9d7636&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;to&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x145834072064DcD9B931237B5aEe217c241e3644&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x3635c9adc5dea00000&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gas&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x5208&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gasPrice&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x174876e800&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nonce&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;v&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;r&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x27e5cb110dd198b8fc963d4741ec0840400a6351d9e0c458eed...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;s&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x2c486d8e26da3c867fbcf4ab242af1265a5036c5e23ea42c8ab...&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong><font color=red>from</font></strong> / <strong><font color=red>to</font></strong>: payment transactions specify a <strong>sender</strong> and a <strong>receiver</strong></p>
<p><strong><font color=red>value</font></strong>: you also need to specify <strong>how much you want to send</strong>（转账金额）</p>
<p><strong><font color=red>gas</font></strong> / <strong><font color=red>gasPrice</font></strong>: you might need to <strong>pay for transaction</strong>（交易费）</p>
<p><strong><font color=red>nonce</font></strong>: nonce is the number of the transaction（交易号）</p>
<p><strong><font color=red>data</font></strong>: data is used for <strong>smart contract calls</strong>（用于智能合约）</p>
<p><strong><font color=red>SIGNATURE{v, r, s}</font></strong>:  a transaction needs to be <strong>signed by the sender</strong>（签名）</p>
<p>transactions are identified by the transaction hash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x53fe995edeec7d241791ff32635244e94ecfd722c9fe90f34ddf59082d814514</span><br></pre></td></tr></table></figure>
<blockquote>
<p>You can do queries like these:<br>▸ Check if transaction 0x53fe995 succeeded<br>▸ Find the sender address of transaction 0x53fe995<br>▸ Get the execution results of transaction 0x53fe995</p>
</blockquote>
<h2 id="Distributed-ledger-分布式账本"><a href="#Distributed-ledger-分布式账本" class="headerlink" title="Distributed ledger 分布式账本"></a>Distributed ledger 分布式账本</h2><h3 id="Block-区块"><a href="#Block-区块" class="headerlink" title="Block 区块"></a>Block 区块</h3><blockquote>
<p>a block is just a list of transactions (<strong>block body</strong>)<br>… plus some metadata (<strong>block header</strong>)</p>
</blockquote>
<p><strong><font color=blue>JSON-representation of a block</font></strong>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0xc8f5310402330767adb624f436fa579ca3a6e28bb33f09ec...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;miner&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x1905c5723adf66f14f9a33d6d99263cb00c2992c&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nonce&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x30176787e0290260&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;parentHash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0xb11d32edb8e8f09941000c898269f665d275342694...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;epochNumber&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x4bad97&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;refereeHashes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;transactions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;0x0b5b3d8f542a3c830ec57b83c07d1282241712478edab3ba8e1a05...&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;0x96b46d10999cda47c4fda1dab7e8e29ce68f5b9ae2d707fde008c7...&quot;</span><span class="punctuation">,</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong><font color=red>hash</font></strong>: just like txs, blocks are uniquely identified by their hashes</p>
<p><strong><font color=red>miner</font></strong> &amp; <strong><font color=red>nonce</font></strong>: some information about the creator of the block (see PoW)</p>
<p><strong><font color=red>parentHash</font></strong> / <strong><font color=red>epochNumber</font></strong> / <strong><font color=red>refereeHashes</font></strong>: information about the blocks position on our ledger</p>
<h3 id="Blockchain"><a href="#Blockchain" class="headerlink" title="Blockchain"></a>Blockchain</h3><img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007210215805.png" class="" title="structure of the blockchain">
<h3 id="Tree-graph"><a href="#Tree-graph" class="headerlink" title="Tree-graph"></a>Tree-graph</h3><p>Conflux uses a Tree-Graph ledger instead of a single chain</p>
<blockquote>
<p>… this way, if two blocks are created simultaneously, the system can use both, thus increasing throughput and security</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007210512219.png" class="" title="structure of the tree-graph">
<h3 id="THE-LEDGER-OF-CONFLUX-—-FURTHER-READING"><a href="#THE-LEDGER-OF-CONFLUX-—-FURTHER-READING" class="headerlink" title="THE LEDGER OF CONFLUX — FURTHER READING"></a>THE LEDGER OF CONFLUX — FURTHER READING</h3><ul>
<li>Conflux 101 Webinar<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://youtube.com/playlist?list=PLoO0tXb18JZ8atJW5bU-GCiykL9yfc3xR">youtube.com/playlist?list=PLoO0tXb18JZ8atJW5bU-GCiykL9yfc3xR</a></li>
</ul>
</li>
<li>whitepaper<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://usenix.org/conference/atc20/presentation/li-chenxing">usenix.org/conference/atc20/presentation/li-chenxing</a></li>
</ul>
</li>
<li>technical presentation<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://confluxnetwork.org/static/Conflux_Technical_Presentation_20200309.pdf">confluxnetwork.org/static/Conflux_Technical_Presentation_20200309.pdf</a></li>
</ul>
</li>
</ul>
<h2 id="Smart-contracts-智能合约"><a href="#Smart-contracts-智能合约" class="headerlink" title="Smart contracts 智能合约"></a>Smart contracts 智能合约</h2><img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007210854052.png" class="" title="smart contract">
<p>imagine that your mailbox has <strong>a machine inside</strong> that decides what to do with the coins</p>
<p>moreover, you can also <strong>pass it notes with instructions, not just coins</strong></p>
<p>this machine can be unique to each box, built by its owner</p>
<hr>
<p><strong><font color=blue>JSON-representation of a smart contract transaction</font></strong>:</p>
<p>智能合约的两个特征：</p>
<ul>
<li><strong><font color=red>to</font></strong> starts with an <code>8</code>（normal contract starts with a  <code>1</code>）</li>
<li><strong><font color=red>data</font></strong> field is <strong>not empty</strong>（某种方法签名）</li>
</ul>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007211228922.png" class="" title="JSON-representation of a smart contract transaction">
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x1dBDA5dD2e952914bC74a802510D0FA59F9d7636&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;to&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x8b017126d2fede908a86b36b43969f17d25f3770&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x3635c9adc5dea00000&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gas&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x5208&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gasPrice&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x174876e800&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nonce&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0xa6f2ae3a&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;v&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;r&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x27e5cb110dd198b8fc963d4741ec0840400a6351d9e0c458eed...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;s&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x2c486d8e26da3c867fbcf4ab242af1265a5036c5e23ea42c8ab...&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="transaction-receipt-交易收据"><a href="#transaction-receipt-交易收据" class="headerlink" title="transaction receipt 交易收据"></a>transaction receipt 交易收据</h3><p><strong><font color=blue>JSON-representation of a receipt</font></strong>(收据):</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0xb2988210c05a43ebd76575f5421ef84b120ebf80&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;to&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0xb2988210c05a43ebd76575f5421ef84b120ebf80&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;transactionHash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x53fe995edeec7d241791ff32635244e94ecfd7...&quot;</span></span><br><span class="line">    <span class="attr">&quot;epochNumber&quot;</span><span class="punctuation">:</span> <span class="number">451990</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;blockHash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0xbb1eea3c8a574dc19f7d8311a2096e23a39f12e649a...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;outcomeStatus&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span>   <span class="comment">// 0 means succeed</span></span><br><span class="line">    <span class="attr">&quot;contractCreated&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span>   <span class="comment">// created successfully</span></span><br><span class="line">    <span class="attr">&quot;gasUsed&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x5208&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;logs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;logsBloom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0x0000000000000000000000000000000000000000000...&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong><font color=red>from</font></strong> / <strong><font color=red>to</font></strong> / <strong><font color=red>transactionHash</font></strong>: transaction info</p>
<p><strong><font color=red>epochNumber</font></strong> / <strong><font color=red>blockHash</font></strong> / <strong><font color=red>index</font></strong>: location on the ledger（对某些应用程序有用）</p>
<p><strong><font color=red>outcomeStatus</font></strong> / <strong><font color=red>contractCreated</font></strong> / <strong><font color=red>gasUsed</font></strong> / <strong><font color=red>logs</font></strong> / <strong><font color=red>logsBloom</font></strong>: execution results</p>
<h2 id="Inspect-data-on-the-ledger"><a href="#Inspect-data-on-the-ledger" class="headerlink" title="Inspect data on the ledger"></a>Inspect data on the ledger</h2><h3 id="Conflux-Scan-Blockchain-Explorers"><a href="#Conflux-Scan-Blockchain-Explorers" class="headerlink" title="Conflux Scan(Blockchain Explorers)"></a>Conflux Scan(Blockchain Explorers)</h3><p>blockchain explorers are data aggregators that you can use to <strong>query accounts, transactions, blocks</strong>, etc.</p>
<p>for Conflux, the official blockchain explorer is called <strong>Conflux Scan</strong>（<a target="_blank" rel="noopener external nofollow noreferrer" href="https://confluxscan.io">confluxscan.io</a>）</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201007234130612.png" class="" title="Conflux Scan">
<h2 id="Set-up-wallet-amp-Send-transactions"><a href="#Set-up-wallet-amp-Send-transactions" class="headerlink" title="Set up wallet &amp; Send transactions"></a>Set up wallet &amp; Send transactions</h2><h3 id="wallet’s-usage"><a href="#wallet’s-usage" class="headerlink" title="wallet’s usage"></a>wallet’s usage</h3><p>a keypair represents an identity on the blockchain</p>
<ul>
<li><strong>public key / address</strong>: your public identity</li>
<li><strong>private key</strong>: your authorization to act on behalf of this identity</li>
</ul>
<p>if you know an account’s private key, you can sign transactions from that account</p>
<ul>
<li><strong>storing keys securely is challenging</strong> even for experts</li>
</ul>
<hr>
<ul>
<li><strong><font color=blue>store private keys, create and sign transactions</font></strong></li>
<li><strong><font color=blue>connect to a blockchain node</font></strong></li>
<li><strong><font color=blue>send transactions into the system</font></strong></li>
<li><strong><font color=blue>monitor transaction and account state</font></strong></li>
</ul>
<hr>
<h3 id="Conflux-Portal-Wallet"><a href="#Conflux-Portal-Wallet" class="headerlink" title="Conflux Portal(Wallet)"></a>Conflux Portal(Wallet)</h3><p>Conflux Portal（<a target="_blank" rel="noopener external nofollow noreferrer" href="https://portal.conflux-chain.org">portal.conflux-chain.org</a>） is the wallet we will use for this course</p>
<blockquote>
<p>it is a <strong>browser extension</strong>(浏览器扩展) available for all major browsers</p>
<p>it allows you to send simple transactions or even interact with smart contracts and dapps</p>
<p>Conflux Portal is based on <strong>MetaMask</strong> (Ethereum)</p>
</blockquote>
<h4 id="Create-a-wallet"><a href="#Create-a-wallet" class="headerlink" title="Create a wallet"></a>Create a wallet</h4><ul>
<li>first, we need to install the extension</li>
<li>during onboarding, we can choose whether we want to import and existing wallet or create a new one</li>
<li>the wallet will generate a private key and store it encrypted using a password you choose</li>
<li>instead of a hex string, you’ll see the private key as a mnemonic phrase — 12 English words</li>
</ul>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008002548277.png" class="" title="Created a wallet">
<p>我们可以通过“存入”（Deposit）按钮来获取一些没有任何价值的免费代币。</p>
<p>完成后，截取message的tx字段（交易哈希值），将可以在Conflux Scan上搜索到相应的交易：</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008002946068.png" class="" title="Conflux Scan搜索交易">
<p>执行一笔转账交易：</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008003136978.png" class="" title="执行一笔转账交易">
<h3 id="Wallet-Security-101"><a href="#Wallet-Security-101" class="headerlink" title="Wallet Security 101"></a>Wallet Security 101</h3><ul>
<li>remember: if you lose your private key (seed phrase), no one will be able to recover your funds</li>
<li>remember: if someone gains access to your private key, they can (and will) steal your funds</li>
<li>best to backup seed phrase on a piece of paper or using a password manager</li>
<li>for higher security, use a hardware wallet</li>
</ul>
<h3 id="How-to-acquire-tokens"><a href="#How-to-acquire-tokens" class="headerlink" title="How to acquire tokens?"></a>How to acquire tokens?</h3><p>▸ get free test CFX on testnet or Oceanus through faucet</p>
<p>▸ earn CFX through mining (<a target="_blank" rel="noopener external nofollow noreferrer" href="https://mining.confluxnetwork.org">mining.confluxnetwork.org</a>)</p>
<p>▸ earn FC through bounty (<a target="_blank" rel="noopener external nofollow noreferrer" href="https://bounty.conflux-chain.org">bounty.conflux-chain.org</a>)</p>
<p>▸ earn FC through grants (<a target="_blank" rel="noopener external nofollow noreferrer" href="https://grants.confluxnetwork.org">grants.confluxnetwork.org</a>)</p>
<p>▸ buy FC on <a target="_blank" rel="noopener external nofollow noreferrer" href="https://moondex.io">moondex.io</a> or other exchanges（if you have another digital currency like bitcoin）</p>
<blockquote>
<p>Interactive map of Conflux nodes (<a target="_blank" rel="noopener external nofollow noreferrer" href="http://confluxmap.com/">confluxmap.com 5</a>)</p>
</blockquote>
<h2 id="Interact-with-dapps-去中心化应用"><a href="#Interact-with-dapps-去中心化应用" class="headerlink" title="Interact with dapps(去中心化应用)"></a>Interact with dapps(去中心化应用)</h2><p>Demo：<a target="_blank" rel="noopener external nofollow noreferrer" href="http://167.172.160.61">http://167.172.160.61</a></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008004353768.png" class="" title="买一张ticket">
<p>查询相应的智能合约交易记录：</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008004514650.png" class="" title="transaction">
<h1 id="Homework-of-Lecture-3"><a href="#Homework-of-Lecture-3" class="headerlink" title="Homework of Lecture 3"></a>Homework of Lecture 3</h1><blockquote>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.conflux.fun/t/topic/2910">Lecture 3 - Homework &amp; Resources</a></p>
<blockquote>
<p>Homework is done by a group.</p>
</blockquote>
</blockquote>
<h2 id="transaction-classification"><a href="#transaction-classification" class="headerlink" title="transaction classification"></a>transaction classification</h2><p>1)On which network is this transaction? <code>0xb97e091e42252571072ae9c605bda16c8f2568cb6a4ff8fd717d384123074b55</code></p>
<blockquote>
<p>Conflux now have a test network(<strong>Conflux Testnet</strong>) , and a pre-mainnet network(<strong>Conflux Oceanus</strong>).</p>
<p>But none of those networks have the requested transaction.</p>
</blockquote>
<h2 id="block-match-search"><a href="#block-match-search" class="headerlink" title="block match search"></a>block match search</h2><p>2)Find a block with 20 or more transactions and send us the block hash.</p>
<blockquote>
<p>0x618f924e1f6c7eab371551d8a5e407aeecd9a192bdd130204dc1ccc42566360f</p>
<blockquote>
<p>note: this block is from the <strong>Conflux Testnet</strong>,and contains <strong>280</strong> transactions.</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008022034530.png" class="" title="block">
<p>And there is a JS code to automatically find a block with 20 or more transactions:</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Conflux</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;js-conflux-sdk&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// initalize a Conflux object</span></span><br><span class="line">  <span class="keyword">const</span> cfx = <span class="keyword">new</span> <span class="title class_">Conflux</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;http://mainnet-jsonrpc.conflux-chain.org:12537&#x27;</span>,</span><br><span class="line">    <span class="attr">defaultGasPrice</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">defaultGas</span>: <span class="number">1000000</span>,</span><br><span class="line">    <span class="attr">logger</span>: <span class="variable language_">console</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> epochStart = <span class="number">7742635</span></span><br><span class="line">  <span class="keyword">let</span> answer = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = epochStart; i&gt; <span class="number">0</span>; i--)&#123;</span><br><span class="line">    <span class="keyword">const</span> blockArray = <span class="keyword">await</span> cfx.<span class="title function_">getBlocksByEpochNumber</span>(i)</span><br><span class="line">    <span class="keyword">for</span> (block <span class="keyword">in</span> blockArray) &#123;</span><br><span class="line">        <span class="keyword">let</span> result = <span class="keyword">await</span> cfx.<span class="title function_">getBlockByHash</span>(blockArray[block])</span><br><span class="line">        <span class="keyword">if</span> (result[<span class="string">&#x27;transactions&#x27;</span>].<span class="property">length</span> &gt;=<span class="number">20</span> ) &#123;</span><br><span class="line">            answer = result[<span class="string">&#x27;hash&#x27;</span>]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (answer) <span class="keyword">break</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;result is &#x27;</span> + answer)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>By running it, we can find the results: <code>0x273d13668462ae7cbb14f25fea0eb8bdbac2dfcd4571a3c5139f08a864d160ba</code></p>
<blockquote>
<p>note: this block is from the <strong>Conflux Oceanus</strong>,and contains <strong>22</strong> transactions.</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008110908510.png" class="" title="0x273d13668462ae7cbb14f25fea0eb8bdbac2dfcd4571a3c5139f08a864d160ba">
<p>Here is the running test:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008114435446.png" class="" title="running test">
</blockquote>
<h2 id="failed-transaction"><a href="#failed-transaction" class="headerlink" title="failed transaction"></a>failed transaction</h2><p>3)Try to find a failed transaction. Did the sender retry?</p>
<blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008014307350.png" class="" title="failed transactions">
<blockquote>
<p><em>Failed First try:**</em>0x6151cf6ceb0d2156e6f35c258d94e27ebc299d149ee664544db343c8e5d29520**</p>
<p><em>Failed Second try:</em> <strong>0x7635749799dafce791bb952d7a83859c1c4faca8f6cb3d2652fabb073a992241</strong></p>
<p><em>Successful Third try:</em></p>
<p><strong>0x6151cf6ceb0d2156e6f35c258d94e27ebc299d149ee664544db343c8e5d29520</strong></p>
</blockquote>
<p>Doing smart contract actually also has failed several transactions…</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008013717131.png" class="" title="failed transaction">
</blockquote>
<h2 id="CFX-faucet-test"><a href="#CFX-faucet-test" class="headerlink" title="CFX faucet test"></a>CFX faucet test</h2><p>4)Create a wallet, get some CFX <strong>through the faucet</strong> and send us the corresponding transactions hash.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;code&quot;:0,&quot;message&quot;:&#123;&quot;tx&quot;:&quot;0x0163755fe87b34053d2f949ba757b23f3fdbff47ac73b3b0af3e8fb2cabba2d4&quot;&#125; &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Use “Deposit” button to get free CFX~~</p>
<p>0x0163755fe87b34053d2f949ba757b23f3fdbff47ac73b3b0af3e8fb2cabba2d4</p>
</blockquote>
<h2 id="buy-a-ticket"><a href="#buy-a-ticket" class="headerlink" title="buy a ticket"></a>buy a ticket</h2><p>5)Buy a ticket on 167.172.160.61 and send us the corresponding transaction hash.<br>5.1)What happens if you lower the gas limit before sending the transaction?<br>5.2)What happens if you try to buy a second ticket for the same address?</p>
<blockquote>
<p>5）0xbc6e65773ce248c40743c4cbad6472284f3b2a2ab9ef6b86e1a2734b049c0248</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008004632381.png" class="" title="buy a ticket">
<p>5.1）there is a minimal gas limit:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008004932339.png" class="" title="gas limit is at least 21000">
<p>When I lower the gas limit, I get a failed transaction: (<strong>Out of gas</strong>)</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008005312172.png" class="" title="a failed transaction">
<p>5.2）When I try to buy a second ticket for the same address, I get a failed transaction: (<strong>Execution error</strong>, maybe the smart contract constraints that <strong>one address can only buy one ticket</strong>)</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008005449147.png" class="" title="buy a second ticket">
<p>On the contrary, if I choose to buy a second ticket from another account(address):（first, need unauthorize the website, and reconnect to choose another account）</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008010009472.png" class="" title="buy a second ticket from another account">
</blockquote>
<h3 id="query-ticket-purchases"><a href="#query-ticket-purchases" class="headerlink" title="query ticket purchases"></a>query ticket purchases</h3><p>6)Try querying recent ticket purchases. Has there been any?</p>
<blockquote>
<p>Yes. Use the <code>Purchase</code> method: (And that <code>&quot;0x1e51d..</code> address is one of my account)</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008010347232.png" class="" title="query recent ticket purchases">
</blockquote>
<h3 id="creator-of-the-Tickets-contract"><a href="#creator-of-the-Tickets-contract" class="headerlink" title="creator of the Tickets contract"></a>creator of the Tickets contract</h3><p>7)Who is the creator of the Tickets contract?</p>
<blockquote>
<p>First, use <code>owner</code> method to get an address:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008011005416.png" class="" title="owner">
<p>Then search for the address:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008011130430.png" class="" title="search for the address">
<p>This seems not what we want, so I track which account all the tokens are transferred into:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008011846655.png" class="" title="find an account">
<p>And…search, with two-step validation, I think I’ve found the creator of this contract:</p>
<ul>
<li>most definitely <code>0x1dbda5dd2e952914bc74a802510d0fa59f9d7636</code></li>
</ul>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201008012202607.png" class="" title="search the account">
<p>And I think <code>0x8B017126d2FEDe908a86B36b43969F17d25F3770</code> is the address of this contract. But I couldn’t be able to find any source code of the contract using Conflux Scan.</p>
</blockquote>
<h4 id="balance-of-this-account"><a href="#balance-of-this-account" class="headerlink" title="balance of this account"></a>balance of this account</h4><p>8)What is the balance of this account? How do you think this account acquired these tokens?</p>
<blockquote>
<p>The creator’s address <code>0x1dbda5dd2e952914bc74a802510d0fa59f9d7636</code>:</p>
<ul>
<li><p><strong>31682.677136697254853623 CFX</strong></p>
<p>▸ earn CFX through mining (<a target="_blank" rel="noopener external nofollow noreferrer" href="https://mining.confluxnetwork.org">mining.confluxnetwork.org</a>) mining is reasonable for this address</p>
<p>▸ earn FC through bounty (<a target="_blank" rel="noopener external nofollow noreferrer" href="https://bounty.conflux-chain.org">bounty.conflux-chain.org</a>) design a smart contract might get this</p>
</li>
</ul>
<p>The contract’s address <code>0x8b017126d2fede908a86b36b43969f17d25f3770</code>:</p>
<ul>
<li><p><strong>330 CFX</strong></p>
<p>▸people buy tickets from this address and send it 33 * 10 CFX (which means there are 33 tickets been sold)</p>
</li>
</ul>
</blockquote>
<h2 id="the-most-FC-tokens-address"><a href="#the-most-FC-tokens-address" class="headerlink" title="the most FC tokens address"></a>the most FC tokens address</h2><p>9)Which address holds the most FC tokens?</p>
<blockquote>
<ol>
<li>the conflux system address<ol>
<li>System is responsible for 1:1 exchange of FC/CFX transactions<ol>
<li>In this scenario, the contract creator’s address <code>0x144aa8f554d2ffbc81e0aa0f533f76f5220db09c</code> might have had the most FC tokens because this address is currently holding an enormous amount of CFX roughly about 999999996999988 CFX. That’s really something.</li>
</ol>
</li>
<li>System delivers FC tokens to all other users</li>
<li>So in theory it should hold the most FC tokens</li>
</ol>
</li>
<li><code>0x1878e9b8d2fec316a2e666485b927e92a3b4f43e</code><ol>
<li>This address holds 55999 FC tokens, and was involved in the first FC contract transaction</li>
<li>Considering the total amount of FC tokens is about 4484424 FC tokens, this could also have a great chance to be the address that holds the most FC tokens</li>
</ol>
</li>
</ol>
</blockquote>
<h1 id="Lecture-4-Introduction-to-Smart-Contracts"><a href="#Lecture-4-Introduction-to-Smart-Contracts" class="headerlink" title="Lecture 4 - Introduction to Smart Contracts"></a>Lecture 4 - Introduction to Smart Contracts</h1><h2 id="Decentralized-Applications-Architecture"><a href="#Decentralized-Applications-Architecture" class="headerlink" title="Decentralized Applications Architecture"></a>Decentralized Applications Architecture</h2><h3 id="Traditional-Web-Applications-Web-2-0"><a href="#Traditional-Web-Applications-Web-2-0" class="headerlink" title="Traditional Web Applications (Web 2.0)"></a>Traditional Web Applications (Web 2.0)</h3><img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201015193226448.png" class="" title="Web 2.0">
<p><strong>Web 2.0</strong> uses the C/S model.</p>
<ul>
<li>Enter domian, retrieve frontend through HTTP(S)</li>
<li>User interacts with the frontend which might send additional requests to the backend (dynamic content)</li>
<li>The backend could be a server cluster or a cloud, but the main logic remains the same</li>
</ul>
<h3 id="Decentalized-Applications-Web-3-0"><a href="#Decentalized-Applications-Web-3-0" class="headerlink" title="Decentalized Applications (Web 3.0)"></a>Decentalized Applications (Web 3.0)</h3><img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201015200907786.png" class="" title="Web 3.0">
<p><strong>Web 3.0</strong> uses the P2P model (partly):</p>
<ul>
<li>Get frontend from server</li>
<li>Frontend initiates transaction</li>
<li>User approves transaction</li>
<li>There might still be dynamic content</li>
<li>Backend can also query the blockchain</li>
</ul>
<hr>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201015212005851.png" class="" title="Web 2.0 vs. Web 3.0">
<p>IPFS（星际文件系统）：一个去中心化的文件存储系统。</p>
<h2 id="Conflux-Studio-Overview"><a href="#Conflux-Studio-Overview" class="headerlink" title="Conflux Studio Overview"></a>Conflux Studio Overview</h2><blockquote>
<p><strong>a 3rd-party IDE</strong> called Conflux Studio</p>
</blockquote>
<h3 id="Toolchain"><a href="#Toolchain" class="headerlink" title="Toolchain"></a>Toolchain</h3><p>we will use these tools<br>▸ Conflux Studio (v0.4.1) <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ObsidianLabs/ConfluxStudio/blob/master/README.md">https://github.com/ObsidianLabs/ConfluxStudio/blob/master/README.md</a><br>▸ Docker (latest) <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a><br>▸ Solidity 7.1, solc (v0.7.1)<br>▸ Conflux Truffle (v.0.0.8)<br>▸ conflux-rust (v.0.6.3</p>
<h3 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h3><p>Docker的原理是在本地运行一个conflux节点，实际上整个网络都在本地，但只包含一个节点，所以非常适合本地开发。</p>
<p>下载课程的智能合约示例：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-4-tickets.zip">https://github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-4-tickets.zip</a></p>
<blockquote>
<p>在studio中打开上述项目，注意路径名不要有中文。</p>
</blockquote>
<h2 id="Writing-Smart-Contracts"><a href="#Writing-Smart-Contracts" class="headerlink" title="Writing Smart Contracts"></a>Writing Smart Contracts</h2><p>The code that is executed is called <strong><font color=red>EVM bytecode</font></strong>. We write contracts in higher-level languages, the most popular language used on Ethereum and Conflux is <strong><font color=red>Solidity</font></strong>.</p>
<blockquote>
<p>为智能合约专门设计的高级语言。</p>
<p><strong>EVM bytecode</strong>：Ethereum Virtual Machine bytcode 以太坊虚拟机字节码</p>
<p>CVM：Conflux Virtual Machine（和EVM基本一致，智能合约的编写是兼容的）</p>
</blockquote>
<p><code>example.sol</code> :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0</span></span><br><span class="line"></span><br><span class="line">pragma solidity ^<span class="number">0.7</span><span class="number">.1</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">ContractName</span> &#123;</span><br><span class="line">    uint256 number;</span><br><span class="line">    address owner;</span><br><span class="line">    mapping (<span class="function"><span class="params">address</span> =&gt;</span> uint256) counts;  <span class="comment">// 字典</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">uint256 value</span>) public &#123;</span><br><span class="line">    	counts[owner] = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>abi.json</code> :</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;foo&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;function&quot;</span></span><br><span class="line">        <span class="attr">&quot;inputs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;internalType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;uint256&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;val&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;uint256&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;outputs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;stateMutability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nonpayable&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h2 id="Tockets-sol"><a href="#Tockets-sol" class="headerlink" title="Tockets.sol"></a>Tockets.sol</h2><p>讲了讲怎么使用。。</p>
<hr>
<p>introduction to dapps<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://ethereum.org/en/developers/docs/dapps">ethereum.org/en/developers/docs/dapps</a></p>
<p>built on Ethereum — dapp examples<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.ethhub.io/built-on-ethereum/built-on-ethereum">docs.ethhub.io/built-on-ethereum/built-on-ethereum</a></p>
<p>official Solidity 7.1 documentation<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://solidity.readthedocs.io/en/v0.7.1">solidity.readthedocs.io/en/v0.7.1</a></p>
<p>learn X in Y minutes (where X=Solidity) warning! earlier Solidity version<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://learnxinyminutes.com/docs/solidity">learnxinyminutes.com/docs/solidity</a></p>
<p>Solidity by example warning! earlier Solidity version<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://solidity-by-example.org/0.6">solidity-by-example.org/0.6</a></p>
<p>CryptoZombies<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://cryptozombies.io">cryptozombies.io</a></p>
<hr>
<p>Conflux Studio overview<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ObsidianLabs/ConfluxStudio/blob/master/README.md">github.com/ObsidianLabs/ConfluxStudio/blob/master/README.md</a></p>
<p>dapp tutorial<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ObsidianLabs/conflux-dapp-tutorial">github.com/ObsidianLabs/conflux-dapp-tutorial</a></p>
<p>Conflux frontend example project<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ObsidianLabs/conflux-frontend-react">github.com/ObsidianLabs/conflux-frontend-react</a></p>
<hr>
<p>Solidity Security: Comprehensive list of known attack vectors and common anti-patterns<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.sigmaprime.io/solidity-security.html">blog.sigmaprime.io/solidity-security.html</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/zxhubo/Knowledge-Base">github.com/zxhubo/Knowledge-Base</a></p>
<p>the Ethernaut (by OpenZeppelin)<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://ethernaut.openzeppelin.com">ethernaut.openzeppelin.com</a></p>
<h1 id="Homework-of-Lecture-4"><a href="#Homework-of-Lecture-4" class="headerlink" title="Homework of Lecture 4"></a>Homework of Lecture 4</h1><blockquote>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.conflux.fun/t/topic/3390">Lecture 4 - Homework &amp; Resources</a></p>
<blockquote>
<p>Homework is done by a group.</p>
</blockquote>
</blockquote>
<h2 id="Conflux-Studio"><a href="#Conflux-Studio" class="headerlink" title="Conflux Studio"></a>Conflux Studio</h2><p><strong>3.1 Basic usage of Conflux Studio</strong></p>
<p>Download and install Conflux Studio and all the components required.</p>
<ul>
<li>Docker: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.docker.com/get-docker">https://docs.docker.com/get-docker 12</a></li>
<li>Conflux Studio: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ObsidianLabs/ConfluxStudio/releases/tag/v0.4.1">https://github.com/ObsidianLabs/ConfluxStudio/releases/tag/v0.4.1 12</a></li>
<li>Conflux Truffle, conflux-rust, solc: Install through Conflux Studio</li>
</ul>
<blockquote>
<p>Done.</p>
</blockquote>
<p>Download the Tickets project from the lecture (<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-4-tickets.zip">https://github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-4-tickets.zip</a>) and import it into Conflux Studio.</p>
<blockquote>
<p>Done.</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201015235330134.png" class="" title="the Tickets project">
</blockquote>
<p>Deploy an instance of the contract on Conflux Oceanus (hint: you can send CFX from your Conflux Portal account to your Conflux Studio account).</p>
<blockquote>
<p>get CFX from faucet: wallet.confluxscan.io/faucet/dev/ask?address={address}</p>
<blockquote>
<p>To <strong>make sure the deploying account has enough CFXs to pay transaction fees</strong>.</p>
<p>Or (send CFX from your Conflux Portal account to your Conflux Studio account)</p>
</blockquote>
<p>And Deploy~</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016000956618.png" class="" title="Deploy an instance of the contract">
</blockquote>
<p>Buy a ticket from another account. Validate the ticket with the owner. Withdraw the profits.</p>
<blockquote>
<p>First, find the contract we deployed, which leads us to the contract method’s panal:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016001705433.png" class="" title="contract method" alt="s panal">
<p>And we just buy, validate, and withdraw.</p>
</blockquote>
<p>Send us the address of the contract, the 4 transaction hashes (deploy, buy(), validate(), withdraw()), and screenshots of how you sent them from Conflux Studio.</p>
<blockquote>
<p><strong>deploy</strong>: <code>0x1c5d87cbc299df5f2d5f07d989e2df83ebca253838edb0836b86d24587b72878</code></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016001609824.png" class="" title="contract">
<p><strong>buy</strong>: <code>0xcfbdf3ae39291ea42c85142e18514d4d7329a88057fa8811f043a7869619bcb6</code></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016002315094.png" class="" title="buy">
<p><strong>validate</strong>: <code>0xe4e4dbbc708a7e5e5272e8323d124052297ed4dd6ae772da8b2bc9a416b0f2d7</code></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016002453805.png" class="" title="validate">
<p><strong>withdraw</strong>: <code>0x367034b42d8cce63f19cf585b3644587e084f8456fd3a562f223dfdd7341c3f9</code></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016002721904.png" class="" title="withdraw">
</blockquote>
<h2 id="Tickets-sol"><a href="#Tickets-sol" class="headerlink" title="Tickets.sol"></a>Tickets.sol</h2><p><strong>3.2 Customizing Tickets.sol</strong></p>
<p>Update Ticket.sol so that it becomes possible to <strong>set the number of tickets and the price per ticket</strong> <font color=red>when you deploy a contract</font>.</p>
<p>For instance, for event A, I want to sell 10 tickets of 100 CFX each. For event B, I want to sell 1000 tickets for 2 CFX each.</p>
<p>Test your solution on a local development network.</p>
<p>Send us the source code and a screenshot of deploying a contract with 33 tickets for 44 CFX each.</p>
<blockquote>
<p>Just set a few constructor’s parameters and all is OK.</p>
</blockquote>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">constructor</span>(uint256 tickets, uint256 price) &#123;</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">    num_tickets = tickets;</span><br><span class="line">    price_drips = price * <span class="number">1e18</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Then we get a panal with adjustable number of tickets and price for each.</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016120636955.png" class="" title="Deploy">
<blockquote>
<p>Send the transaction, and check:</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016120734072.png" class="" title="check the parameters">
<h3 id="Buy-tickets"><a href="#Buy-tickets" class="headerlink" title="Buy tickets"></a>Buy tickets</h3><p><strong>+1. Buying multiple tickets from one address [OPTIONAL]</strong></p>
<p>Update Tickets.sol so that <strong>one user can buy multiple tickets</strong>. For instance, Bob might want to buy 2 tickets, one for himself and one for his girlfriend.</p>
<p>Test your solution on a local development network.</p>
<p>Send us the source code and some screenshots of buying 2 or more tickets from an address and then validating them.</p>
<blockquote>
<p>Source code:</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0</span></span><br><span class="line"></span><br><span class="line">pragma solidity ^<span class="number">0.7</span><span class="number">.1</span>;</span><br><span class="line"></span><br><span class="line">contract Tickets &#123;</span><br><span class="line">    address <span class="keyword">public</span> owner;</span><br><span class="line"></span><br><span class="line">    uint256 <span class="keyword">public</span> num_tickets = <span class="number">100</span>;</span><br><span class="line">    uint256 <span class="keyword">public</span> price_drips = <span class="number">10</span> * <span class="number">1e18</span>; <span class="comment">// 10 CFX</span></span><br><span class="line">    <span class="built_in">mapping</span> (address =&gt; uint256) <span class="keyword">public</span> has_ticket;</span><br><span class="line"></span><br><span class="line">    <span class="function">event <span class="title">Validated</span><span class="params">(address visitor, uint256 tickets)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">constructor</span>(uint256 tickets, uint256 price) &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">        num_tickets = tickets;</span><br><span class="line">        price_drips = price * <span class="number">1e18</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// buy ticket</span></span><br><span class="line">    <span class="function">function <span class="title">buy</span><span class="params">(uint256 tickets)</span> <span class="keyword">public</span> payable </span>&#123;</span><br><span class="line">        <span class="comment">// check tickets</span></span><br><span class="line">        <span class="built_in">require</span>(num_tickets &gt; <span class="number">0</span> &amp;&amp; tickets &lt;= num_tickets &amp;&amp; tickets &gt; <span class="number">0</span>, <span class="string">&quot;TICKETS: illegal operation&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// check if the buying price is correct</span></span><br><span class="line">        <span class="built_in">require</span>(msg.value == tickets * price_drips, <span class="string">&quot;TICKETS: incorrect amount&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// successful buy</span></span><br><span class="line">        <span class="keyword">if</span>( has_ticket[msg.sender] != <span class="number">0</span> )</span><br><span class="line">            has_ticket[msg.sender] += tickets;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            has_ticket[msg.sender] = tickets;</span><br><span class="line">        num_tickets -= tickets;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// validate ticket</span></span><br><span class="line">    <span class="function">function <span class="title">validate</span><span class="params">(address visitor)</span> <span class="keyword">public</span> </span>&#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.sender == owner, <span class="string">&quot;TICKETS: unauthorized&quot;</span>);</span><br><span class="line">        <span class="built_in">require</span>(has_ticket[visitor] &gt; <span class="number">0</span>, <span class="string">&quot;TICKETS: visitor has no ticket&quot;</span>);</span><br><span class="line"></span><br><span class="line">        uint256 tickets = has_ticket[visitor];</span><br><span class="line">        has_ticket[visitor] = <span class="number">0</span>;</span><br><span class="line">        <span class="function">emit <span class="title">Validated</span><span class="params">(visitor, tickets)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// withdraw profit</span></span><br><span class="line">    <span class="function">function <span class="title">withdraw</span><span class="params">()</span> <span class="keyword">public</span> </span>&#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.sender == owner, <span class="string">&quot;TICKETS: unauthorized&quot;</span>);</span><br><span class="line">        uint256 profit = <span class="built_in">address</span>(<span class="keyword">this</span>).balance;</span><br><span class="line">        msg.sender.<span class="built_in">transfer</span>(profit);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>We set tickets_num to <code>2333</code>, and price to <code>1</code> CFX. (And buy 5 tickets.)</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016122836503.png" class="" title="num_tickets">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016122857302.png" class="" title="price_drips">
<blockquote>
<p>buying 2 or more tickets from an address:</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016122729183.png" class="" title="buy 5 tickets for Calvin">
<blockquote>
<p>validating them:</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016123108333.png" class="" title="validate">
<h3 id="Time-of-the-event"><a href="#Time-of-the-event" class="headerlink" title="Time of the event"></a>Time of the event</h3><p>+<strong>1. Time of the event [OPTIONAL]</strong></p>
<p>Update Tickets.sol so that the organizer can set the time of the event.</p>
<p>Allow users to <strong>buy tickets up to 2 hours before the event</strong>. E.g. if the event is on 2020.12.01 19:00, you cannot buy tickets after 2020.12.01 17:00.</p>
<p>Allow the organizer to <strong>withdraw the profits 1 day after the event</strong>. E.g. if the event is on 2020.12.01 19:00, the organizer cannot withdraw the profits before 2020.12.02 19:00.</p>
<p><strong>Hints:</strong></p>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://solidity.readthedocs.io/en/v0.7.1/units-and-global-variables.html#block-and-transaction-properties">https://solidity.readthedocs.io/en/v0.7.1/units-and-global-variables.html#block-and-transaction-properties 6</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://solidity.readthedocs.io/en/v0.7.1/units-and-global-variables.html#time-units">https://solidity.readthedocs.io/en/v0.7.1/units-and-global-variables.html#time-units 6</a></li>
</ul>
<blockquote>
<p>Source code:</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0</span></span><br><span class="line"></span><br><span class="line">pragma solidity ^<span class="number">0.7</span><span class="number">.1</span>;</span><br><span class="line"></span><br><span class="line">contract Tickets &#123;</span><br><span class="line">    address <span class="keyword">public</span> owner;</span><br><span class="line"></span><br><span class="line">    uint256 <span class="keyword">public</span> num_tickets = <span class="number">100</span>;</span><br><span class="line">    uint256 <span class="keyword">public</span> price_drips = <span class="number">10</span> * <span class="number">1e18</span>; <span class="comment">// 10 CFX</span></span><br><span class="line">    uint256 <span class="keyword">public</span> start;</span><br><span class="line">    <span class="built_in">mapping</span> (address =&gt; uint256) <span class="keyword">public</span> has_ticket;</span><br><span class="line"></span><br><span class="line">    <span class="function">event <span class="title">Validated</span><span class="params">(address visitor, uint256 tickets)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">constructor</span>(uint256 tickets, uint256 price, uint256 upcoming_days_of_the_event) &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">        num_tickets = tickets;</span><br><span class="line">        price_drips = price * <span class="number">1e18</span>;</span><br><span class="line">        start = upcoming_days_of_the_event * <span class="number">1</span> days + block.timestamp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// buy ticket</span></span><br><span class="line">    <span class="function">function <span class="title">buy</span><span class="params">(uint256 tickets)</span> <span class="keyword">public</span> payable </span>&#123;</span><br><span class="line">        <span class="comment">// check time</span></span><br><span class="line">        <span class="built_in">require</span>(block.timestamp &lt;= start - <span class="number">2</span> hours, <span class="string">&quot;TICKETS: can&#x27;t but due to time reasons&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// check tickets</span></span><br><span class="line">        <span class="built_in">require</span>(num_tickets &gt; <span class="number">0</span> &amp;&amp; tickets &lt;= num_tickets &amp;&amp; tickets &gt; <span class="number">0</span>, <span class="string">&quot;TICKETS: illegal operation&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// check if the buying price is correct</span></span><br><span class="line">        <span class="built_in">require</span>(msg.value == tickets * price_drips, <span class="string">&quot;TICKETS: incorrect amount&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// successful buy</span></span><br><span class="line">        <span class="keyword">if</span>( has_ticket[msg.sender] != <span class="number">0</span> )</span><br><span class="line">            has_ticket[msg.sender] += tickets;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            has_ticket[msg.sender] = tickets;</span><br><span class="line">        num_tickets -= tickets;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// validate ticket</span></span><br><span class="line">    <span class="function">function <span class="title">validate</span><span class="params">(address visitor)</span> <span class="keyword">public</span> </span>&#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.sender == owner, <span class="string">&quot;TICKETS: unauthorized&quot;</span>);</span><br><span class="line">        <span class="built_in">require</span>(has_ticket[visitor] &gt; <span class="number">0</span>, <span class="string">&quot;TICKETS: visitor has no ticket&quot;</span>);</span><br><span class="line"></span><br><span class="line">        uint256 tickets = has_ticket[visitor];</span><br><span class="line">        has_ticket[visitor] = <span class="number">0</span>;</span><br><span class="line">        <span class="function">emit <span class="title">Validated</span><span class="params">(visitor, tickets)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// withdraw profit</span></span><br><span class="line">    <span class="function">function <span class="title">withdraw</span><span class="params">()</span> <span class="keyword">public</span> </span>&#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.sender == owner, <span class="string">&quot;TICKETS: unauthorized&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">require</span>(block.timestamp &gt;= start + <span class="number">1</span> days, <span class="string">&quot;TICKETS: can&#x27;t withdraw due to time reasons&quot;</span>);</span><br><span class="line"></span><br><span class="line">        uint256 profit = <span class="built_in">address</span>(<span class="keyword">this</span>).balance;</span><br><span class="line">        msg.sender.<span class="built_in">transfer</span>(profit);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Set the start time as 3 days later:</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016133242321.png" class="" title="deploy">
<blockquote>
<p>Let’s buy some tickets and test if we can withdraw the money ahead of schdule:</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016133717044.png" class="" title="withdraw test">
<blockquote>
<p>Now we can see:</p>
<blockquote>
<p>Transaction reverted</p>
<p><strong>data</strong> TICKETS: can’t withdraw due to time reasons</p>
</blockquote>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201016133747376.png" class="" title="failed">
<h1 id="Lecture-5-Introduction-to-Smart-Contracts-II"><a href="#Lecture-5-Introduction-to-Smart-Contracts-II" class="headerlink" title="Lecture 5 - Introduction to Smart Contracts II"></a>Lecture 5 - Introduction to Smart Contracts II</h1><blockquote>
<p><em>No slides, only demos.</em></p>
</blockquote>
<h2 id="minting-burning-logic"><a href="#minting-burning-logic" class="headerlink" title="minting / burning logic"></a>minting / burning logic</h2><p>minting即铸币，burning即销毁。这部分的逻辑控制代币的产生和消失。</p>
<p>minting ~ token issuance(发行):</p>
<ul>
<li>fixed-supply token</li>
<li>set of addresses to mint, e.g. stablecoin<ul>
<li>管理者有权超发货币</li>
</ul>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0-or-later</span></span><br><span class="line"></span><br><span class="line">pragma solidity ^<span class="number">0.7</span><span class="number">.1</span>;</span><br><span class="line"></span><br><span class="line">import <span class="string">&quot;./IStandardCoin.sol&quot;</span>;</span><br><span class="line"></span><br><span class="line">contract CourseCoin is IStandardCoin &#123; <span class="comment">// inheritance / implementing an interface</span></span><br><span class="line">    <span class="built_in">string</span> _name;</span><br><span class="line">    <span class="built_in">string</span> _symbol; <span class="comment">// ~ CFX</span></span><br><span class="line">    uint256 _totalSupply;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// keep track of account balances</span></span><br><span class="line">    mapping (address =&gt; uint256) _balances;</span><br><span class="line"></span><br><span class="line">    event <span class="title function_">Transfer</span><span class="params">(address from, address to, uint256 amount)</span>;</span><br><span class="line"></span><br><span class="line">    constructor(uint256 totalSupply) &#123;</span><br><span class="line">        _name = <span class="string">&quot;Conflux UMA Token&quot;</span>;</span><br><span class="line">        _symbol = <span class="string">&quot;UMA&quot;</span>;</span><br><span class="line">        _totalSupply = totalSupply;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// add all tokens to creator</span></span><br><span class="line">        _balances[msg.sender] = totalSupply;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getters</span></span><br><span class="line">    function <span class="title function_">name</span><span class="params">()</span> external view <span class="title function_">returns</span> <span class="params">(<span class="built_in">string</span> memory)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">symbol</span><span class="params">()</span> external view <span class="title function_">returns</span> <span class="params">(<span class="built_in">string</span> memory)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _symbol;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">balanceOf</span><span class="params">(address addr)</span> external view override <span class="title function_">returns</span> <span class="params">(uint256)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _balances[addr];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">totalSupply</span><span class="params">()</span> external view override <span class="title function_">returns</span> <span class="params">(uint256)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _totalSupply;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// transfer between accounts</span></span><br><span class="line">    function <span class="title function_">transfer</span><span class="params">(address receiver, uint256 amount)</span> external override &#123;</span><br><span class="line">        require(_balances[msg.sender] &gt;= amount, <span class="string">&quot;CourseCoin: Insufficient balance&quot;</span>);</span><br><span class="line">        _balances[msg.sender] -= amount;</span><br><span class="line">        _balances[receiver] += amount;</span><br><span class="line">        emit <span class="title function_">Transfer</span><span class="params">(msg.sender, receiver, amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="TimeLockedTransfer"><a href="#TimeLockedTransfer" class="headerlink" title="TimeLockedTransfer"></a>TimeLockedTransfer</h2><p>转账交易执行后，receiver只能在截至时间以后才能提取代币。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0-or-later</span></span><br><span class="line"></span><br><span class="line">pragma solidity ^<span class="number">0.7</span><span class="number">.1</span>;</span><br><span class="line"></span><br><span class="line">import <span class="string">&quot;./IStandardCoin.sol&quot;</span>;</span><br><span class="line"></span><br><span class="line">contract TimeLockedTransfer &#123;</span><br><span class="line">    address _sender;</span><br><span class="line">    address _receiver;</span><br><span class="line">    uint256 _unlockAfter; <span class="comment">// point in time</span></span><br><span class="line"></span><br><span class="line">    event <span class="title function_">CFXDeposit</span><span class="params">(uint256 amount)</span>;</span><br><span class="line">    event <span class="title function_">CFXWithdraw</span><span class="params">(uint256 amount)</span>;</span><br><span class="line">    event <span class="title function_">CoinDeposit</span><span class="params">(uint256 amount)</span>;</span><br><span class="line">    event <span class="title function_">CoinWithdraw</span><span class="params">(uint256 amount)</span>;</span><br><span class="line"></span><br><span class="line">    constructor(address sender, address receiver, uint256 lockTimeSec) &#123;</span><br><span class="line">        _sender = sender;</span><br><span class="line">        _receiver = receiver;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// current time: `block.timestamp` (`now` in older versions)</span></span><br><span class="line">        _unlockAfter = block.timestamp + lockTimeSec;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">balance</span><span class="params">()</span> external view <span class="title function_">returns</span> <span class="params">(uint256)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">depositCFX</span><span class="params">()</span> external payable &#123;</span><br><span class="line">        require(msg.sender == _sender, <span class="string">&quot;TLT: Unauthorized&quot;</span>);</span><br><span class="line">        uint256 amount = msg.value;</span><br><span class="line">        emit <span class="title function_">CFXDeposit</span><span class="params">(amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">withdrawCFX</span><span class="params">()</span> external &#123;</span><br><span class="line">        require(msg.sender == _receiver, <span class="string">&quot;TLT: Unauthorized&quot;</span>);</span><br><span class="line">        require(block.timestamp &gt;= _unlockAfter, <span class="string">&quot;TLT: Timelock still active&quot;</span>);</span><br><span class="line">        uint256 amount = address(this).balance;</span><br><span class="line">        msg.sender.transfer(amount);</span><br><span class="line">        emit <span class="title function_">CFXWithdraw</span><span class="params">(amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//function depositCoin(address coinContract) external payable &#123;</span></span><br><span class="line">    <span class="comment">//    require(msg.sender == _sender, &quot;TLT: Unauthorized&quot;);</span></span><br><span class="line">    <span class="comment">//    </span></span><br><span class="line">    <span class="comment">//    IStandardCoin coin = IStandardCoin(coinContract);</span></span><br><span class="line">    <span class="comment">//    uint256 amount = msg.value;</span></span><br><span class="line">    <span class="comment">//    coin.transfer(address(this), amount);</span></span><br><span class="line">    <span class="comment">//    emit CoinDeposit(amount);</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">    function <span class="title function_">withdrawCoin</span><span class="params">(address coinContract)</span> external &#123;</span><br><span class="line">        <span class="comment">// Alice will deposit coins to this contract through the contract</span></span><br><span class="line">        <span class="comment">// Bob can withdraw after the deadline by passing the coin contract address</span></span><br><span class="line">        require(msg.sender == _receiver, <span class="string">&quot;TLT: Unauthorized&quot;</span>);</span><br><span class="line">        require(block.timestamp &gt;= _unlockAfter, <span class="string">&quot;TLT: Timelock still active&quot;</span>);</span><br><span class="line"></span><br><span class="line">        IStandardCoin coin = IStandardCoin(coinContract);</span><br><span class="line">        uint256 amount = coin.balanceOf(address(this));</span><br><span class="line">        coin.transfer(_receiver, amount);</span><br><span class="line">        emit <span class="title function_">CoinWithdraw</span><span class="params">(amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Homework-of-Lecture-5"><a href="#Homework-of-Lecture-5" class="headerlink" title="Homework of Lecture 5"></a>Homework of Lecture 5</h1><blockquote>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.conflux.fun/t/topic/3456">Lecture 5 - Homework &amp; Resources</a></p>
<blockquote>
<p>Homework is done by a group.</p>
</blockquote>
</blockquote>
<h2 id="3-1-Understanding-the-lecture"><a href="#3-1-Understanding-the-lecture" class="headerlink" title="3.1 Understanding the lecture"></a>3.1 Understanding the lecture</h2><p>1.a) Describe some advantages of conforming to a token standard like ERC-20 or IStandardToken in a few sentences.</p>
<blockquote>
<p><i>Conforming to a token standard ensures <strong>interoperability</strong> between our token and other tokens in the token standard network. This makes buying and trading our tokens easier for end users as well as investors, increasing the appeal of our token.</i></p>
<p><i>We can also benefit from <strong>unified efforts at improving the security</strong> of our token standard. The more networks that share the same token standard, the more stakeholders concerned with the token security, the more research is done to improve the token standard security.</i></p>
</blockquote>
<p>1.b) Describe the purpose of the TimeLockedTransfer contract in a few sentences.</p>
<blockquote>
<p><i>The TimeLockedTransfer contract allows us to <strong>set a time for the contract execution</strong>. This means that even if all conditions are already fulfilled by a certain time, the contract will not, or cannot, be executed until the prescribed time arrives.It can be used for <strong>scheduled transfers</strong> or <strong>limiting contract accessibility</strong>.</i></p>
<p><i>If one can not withdraw his profit immediately, one might wanna make sure that his customers won’t come back asking for a refund, which allows the sender to <strong>cancel the transfer before the specified deadline</strong>.</i></p>
</blockquote>
<h2 id="3-2-Trying-the-lecture-code"><a href="#3-2-Trying-the-lecture-code" class="headerlink" title="3.2 Trying the lecture code"></a>3.2 Trying the lecture code</h2><p>Download the project (<a target="_blank" rel="noopener external nofollow noreferrer" href="http://github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-5.zip">github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-5.zip 15</a>) and import it into Conflux Studio.</p>
<p>In this problem, you will have to deploy three smart contracts on your <strong>local development network</strong>.</p>
<p>First, deploy a <strong>fixed-supply</strong> standard coin with the name “CoinA”. Then, deploy a second instance with the name “CoinB”.</p>
<blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106231734404.png" class="" title="contracts">
<p>CoinA: 0x8ad093411fb99e82d35c6adfe494821e3d478a70</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106221649667.png" class="" title="CoinA">
<p>CoinB: 0x824eebd198b057a4638842247b0a788e8888ef49</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106223136829.png" class="" title="CoinB">
</blockquote>
<p>Next, deploy an instance of the TimeLockedTransfer contract. Set the unlock time to something greater than 5 minutes.</p>
<blockquote>
<p>TimeLockedTransfer: (time = 301 s &gt; 5 min)</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106231645734.png" class="" title="TimeLockedTransfer">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234806332.png" class="" title="detail">
</blockquote>
<p>Send 17 CFX, 22 CoinA, and 12 CoinB to the transfer contract.</p>
<blockquote>
<p>Send 17 CFX:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106231922911.png" class="" title="Send 17 CFX">
<p>Send 22 CoinA: (Through contract “CoinA”)</p>
<blockquote>
<p>send it to the TimeLockedTransfer contract address.</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106233822291.png" class="" title="Send 22 CoinA">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234706086.png" class="" title="detail">
<p>Send 12 CoinB: (Through contract “CoinB”)</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106233800792.png" class="" title="Send 12 CoinB">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234728598.png" class="" title="detail">
</blockquote>
<p>After the deadline, withdraw all these tokens from the transfer contract.</p>
<blockquote>
<p>withdraw CFX:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234113850.png" class="" title="withdraw CFX">
<blockquote>
<p>after:</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234137147.png" class="" title="change">
<p>withdraw CoinA:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234418328.png" class="" title="withdraw CoinA">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234505423.png" class="" title="coinContract">
<p>withdraw CoinB:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234544548.png" class="" title="withdraw CoinB">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234615735.png" class="" title="coinContract">
<blockquote>
<p>after:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201106234306249.png" class="" title="withdraw">
</blockquote>
</blockquote>
<p>Document the process using screenshots and a short description of each step.</p>
<h2 id="1-Transfer-Factory-OPTIONAL"><a href="#1-Transfer-Factory-OPTIONAL" class="headerlink" title="+1. Transfer Factory [OPTIONAL]"></a>+1. Transfer Factory [OPTIONAL]</h2><p>Look at the file TransferFactory.sol. Try to understand what it does and explain it using your own words.</p>
<p>Show us how to deploy and use this contract.</p>
<blockquote>
<p>It creates and maintains a list of “TimeLockedTransfer” contracts.</p>
<p>Each time the function “create” is called, a new “TimeLockedTransfer” contract is deployed.</p>
<p>Deploy: <code>0x833791606cc08d5e4f5fd9a2d6953faff6c0c494</code></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000207723.png" class="" title="deploy">
<p>Create: (3 times)</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000248108.png" class="" title="create1">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000336701.png" class="" title="para1">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000714298.png" class="" title="create2">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000727118.png" class="" title="para2">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000610545.png" class="" title="create3">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107000640270.png" class="" title="para3">
<p>And we can see those 3 contract infos: (saved in the list called “transfers”)</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107001116958.png" class="" title="infos">
<p>BUT these tranfers doesn’t work like I expected, and all the contract addresses are invalid.</p>
</blockquote>
<h2 id="1-Cancel-transfer-OPTIONAL"><a href="#1-Cancel-transfer-OPTIONAL" class="headerlink" title="+1. Cancel transfer [OPTIONAL]"></a>+1. Cancel transfer [OPTIONAL]</h2><p>Modify TimeLockedTransfer.sol in a way that allows the sender to cancel the transfer before the specified deadline.</p>
<p>Provide a way for the sender to re-aquire all their tokens from the transfer contract after cancelling it.</p>
<blockquote>
<p>Cancel test:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107014651439.png" class="" title="cancel">
<p>The main source code is as follows: (including several changes in other files not showing here)</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0-or-later</span></span><br><span class="line"></span><br><span class="line">pragma solidity ^<span class="number">0.7</span><span class="number">.1</span>;</span><br><span class="line"></span><br><span class="line">import <span class="string">&quot;./IStandardCoin.sol&quot;</span>;</span><br><span class="line"></span><br><span class="line">contract TimeLockedTransfer &#123;</span><br><span class="line">    address _sender;</span><br><span class="line">    address _receiver;</span><br><span class="line">    address [] public contracts;</span><br><span class="line">    uint256 _unlockAfter; <span class="comment">// point in time</span></span><br><span class="line"></span><br><span class="line">    event <span class="title function_">CFXDeposit</span><span class="params">(uint256 amount)</span>;</span><br><span class="line">    event <span class="title function_">CFXWithdraw</span><span class="params">(uint256 amount)</span>;</span><br><span class="line">    event <span class="title function_">CoinDeposit</span><span class="params">(uint256 amount)</span>;</span><br><span class="line">    event <span class="title function_">CoinWithdraw</span><span class="params">(uint256 amount)</span>;</span><br><span class="line">    event <span class="title function_">Cancel</span><span class="params">(uint256 number)</span>;</span><br><span class="line"></span><br><span class="line">    constructor(address sender, address receiver, uint256 lockTimeSec) &#123;</span><br><span class="line">        _sender = sender;</span><br><span class="line">        _receiver = receiver;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// current time: `block.timestamp` (`now` in older versions)</span></span><br><span class="line">        _unlockAfter = block.timestamp + lockTimeSec;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">balance</span><span class="params">()</span> external view <span class="title function_">returns</span> <span class="params">(uint256)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">depositCFX</span><span class="params">()</span> external payable &#123;</span><br><span class="line">        require(msg.sender == _sender, <span class="string">&quot;TLT: Unauthorized&quot;</span>);</span><br><span class="line">        uint256 amount = msg.value;</span><br><span class="line">        emit <span class="title function_">CFXDeposit</span><span class="params">(amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">withdrawCFX</span><span class="params">()</span> external &#123;</span><br><span class="line">        require(msg.sender == _receiver, <span class="string">&quot;TLT: Unauthorized&quot;</span>);</span><br><span class="line">        require(block.timestamp &gt;= _unlockAfter, <span class="string">&quot;TLT: Timelock still active&quot;</span>);</span><br><span class="line">        uint256 amount = address(this).balance;</span><br><span class="line">        msg.sender.transfer(amount);</span><br><span class="line">        emit <span class="title function_">CFXWithdraw</span><span class="params">(amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function <span class="title function_">depositCoin</span><span class="params">(address coinContract)</span> external payable &#123;</span><br><span class="line">        require(msg.sender == _sender, <span class="string">&quot;TLT: Unauthorized&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        contracts.push(coinContract);</span><br><span class="line"></span><br><span class="line">        IStandardCoin coin = IStandardCoin(coinContract);</span><br><span class="line">        uint256 amount = (uint256)(msg.value / <span class="number">1000000000000000000</span>);</span><br><span class="line">        coin.transfer2(msg.sender, address(this), amount);</span><br><span class="line">        emit <span class="title function_">CoinDeposit</span><span class="params">(amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">withdrawCoin</span><span class="params">(address coinContract)</span> external &#123;</span><br><span class="line">        <span class="comment">// Alice will deposit coins to this contract through the contract</span></span><br><span class="line">        <span class="comment">// Bob can withdraw after the deadline by passing the coin contract address</span></span><br><span class="line">        require(msg.sender == _receiver, <span class="string">&quot;TLT: Unauthorized&quot;</span>);</span><br><span class="line">        require(block.timestamp &gt;= _unlockAfter, <span class="string">&quot;TLT: Timelock still active&quot;</span>);</span><br><span class="line"></span><br><span class="line">        IStandardCoin coin = IStandardCoin(coinContract);</span><br><span class="line">        uint256 amount = coin.balanceOf(address(this));</span><br><span class="line">        coin.transfer(msg.sender, amount);</span><br><span class="line">        emit <span class="title function_">CoinWithdraw</span><span class="params">(amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">cancel</span><span class="params">()</span> external&#123;</span><br><span class="line">        require(msg.sender == _sender, <span class="string">&quot;TLT: Unauthorized&quot;</span>);</span><br><span class="line">        require(block.timestamp &lt; _unlockAfter, <span class="string">&quot;TLT: Timelock is no longer active&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// cancel CFX</span></span><br><span class="line">        uint256 amount = address(this).balance;</span><br><span class="line">        msg.sender.transfer(amount);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// cancel other coins</span></span><br><span class="line">        <span class="keyword">for</span>(uint i = <span class="number">0</span>; i &lt; contracts.length; i = i + <span class="number">1</span>)&#123;</span><br><span class="line">            address coinContract = contracts[i];</span><br><span class="line">            IStandardCoin coin = IStandardCoin(coinContract);</span><br><span class="line">            amount = coin.balanceOf(address(this));</span><br><span class="line">            coin.transfer(msg.sender, amount);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        emit <span class="title function_">Cancel</span><span class="params">(amount)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>A more step by step demo:</p>
<p>(1) Deploy it with 10 mins delay:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015032551.png" class="" title="deploy">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015144464.png" class="" title="contract">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015159377.png" class="" title="para">
<p>(2) check the CoinA(<code>2317</code>) and CoinB(<code>1234</code>):</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015306819.png" class="" title="CoinA">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015323150.png" class="" title="CoinB">
<p>(3) send CFX(<code>11</code>), CoinA(<code>12</code>), CoinB(<code>13</code>):</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015430139.png" class="" title="CFX">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015526840.png" class="" title="CoinA">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015510016.png" class="" title="CoinB">
<p>(4) Check CFX(<code>11</code>), the CoinA(<code>2317</code> - <code>12</code> = <code>2305</code>) and CoinB(<code>1234</code> - <code>13</code> = <code>1221</code>):</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015647940.png" class="" title="CFX">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015705803.png" class="" title="CoinA">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015720588.png" class="" title="CoinB">
<p>(5) <strong><font color=red>cancel</font></strong>:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107015925069.png" class="" title="cancel">
<p>CFX(<code>0</code>), CoinA(<code>2317</code>) and CoinB(<code>1234</code>) <strong>again</strong>:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107020002607.png" class="" title="CFX">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107020116644.png" class="" title="CoinA">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107020132737.png" class="" title="CoinB">
</blockquote>
<h1 id="Lecture-6-Gas-and-Gas-Sponsorship"><a href="#Lecture-6-Gas-and-Gas-Sponsorship" class="headerlink" title="Lecture 6 - Gas and Gas Sponsorship"></a>Lecture 6 - Gas and Gas Sponsorship</h1><h2 id="transaction-fee-交易费"><a href="#transaction-fee-交易费" class="headerlink" title="transaction fee 交易费"></a>transaction fee 交易费</h2><h3 id="Bitcoin-比特币"><a href="#Bitcoin-比特币" class="headerlink" title="Bitcoin 比特币"></a>Bitcoin 比特币</h3><p>比特币最大的创新在于系统机制的设计（incentive alignment）。</p>
<h4 id="Miner-Income-矿工收益"><a href="#Miner-Income-矿工收益" class="headerlink" title="Miner Income 矿工收益"></a>Miner Income 矿工收益</h4><p>miners make money by:</p>
<ul>
<li>processing transactions (<strong>transaction fee</strong>) </li>
<li>creating blocks (<strong>block reward</strong>)</li>
</ul>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107022334908.png" class="" title="example">
<blockquote>
<p>如上图，1 coin 作为transaction fee变成了矿工的收入。</p>
</blockquote>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201107022434198.png" class="" title="miner income">
<h4 id="Incentive-Alignment-激励措施"><a href="#Incentive-Alignment-激励措施" class="headerlink" title="Incentive Alignment 激励措施"></a>Incentive Alignment 激励措施</h4><p>一个预先定义好的协议：</p>
<ul>
<li><strong><font color=blue>反向激励</font></strong>：if you deviate from the rules, you will lose money</li>
<li><strong><font color=red>正向激励</font></strong>：instead of attacking the system, you can earn more moneyby actually participating (as a miner)<ul>
<li>理性的参与者，将会接受正向激励</li>
</ul>
</li>
</ul>
<blockquote>
<p>this is the reason a native currency is necessary forpermissionless(无条件的) blockchains like Bitcoin and Conflux</p>
</blockquote>
<h4 id="transaction-fee-as-an-auction-拍卖"><a href="#transaction-fee-as-an-auction-拍卖" class="headerlink" title="transaction fee as an auction 拍卖"></a>transaction fee as an auction 拍卖</h4><p>每个区块内只能储存有限笔交易，因此矿工倾向于将交易费出价更高的交易打包进区块里面。</p>
<p>愿意给出的交易费越高，你的交易将会更快地得到处理。</p>
<h4 id="Bitcoin机制中的漏洞"><a href="#Bitcoin机制中的漏洞" class="headerlink" title="Bitcoin机制中的漏洞"></a>Bitcoin机制中的漏洞</h4><p>自私采矿（selfish mining），这项技术可让矿工赚的钱超过他本应该拿到的合理回报，从而损害系统的公平性。</p>
<p>区块链依赖于信息的快速广泛传播，但是如果矿工手握某些高额交易费的交易信息，那么他可能倾向于把它留在自己手里，获取这笔更高的手续费。</p>
<p>比特币还会形成一定的集中化系统，因为挖矿奖励太稀有了，大家倾向于聚集到矿池中获得更稳定的回报。这在长期来看对比特币系统是一种不利因素。</p>
<h3 id="Ethereum-以太坊"><a href="#Ethereum-以太坊" class="headerlink" title="Ethereum 以太坊"></a>Ethereum 以太坊</h3><p>以太坊和比特币最大的不同在于，引入了<strong>智能合约</strong>。</p>
<p>但是，智能合约的调用消耗是<strong>非常不确定</strong>的：</p>
<ul>
<li>Execution cost: 运行时间可能达到上百万个循环</li>
<li>Storage cost: 可能最大需要额外的上百万的空间消耗</li>
</ul>
<h4 id="Halting-Problem-停机问题"><a href="#Halting-Problem-停机问题" class="headerlink" title="Halting Problem 停机问题"></a>Halting Problem 停机问题</h4><p><strong><font color=red>halting problem</font></strong>(<strong>停机问题</strong>): just by looking at the transaction, you cannot decide if it will ever finish running</p>
<ul>
<li><strong>limit the <font color=blue>language</font></strong> so that you cannot even write such code (Bitcoin)<ul>
<li>this works but might severely limit the types of applications you are able to express</li>
</ul>
</li>
<li>run for a <strong>fixed <font color=blue>duration</font></strong> then terminate (Hyperledger)<ul>
<li>this might harm determinism: code that timeouts on one machine might terminate on another, any they will be unable to reach consensus</li>
</ul>
</li>
<li>terminate after a <strong>certain number of <font color=blue>steps</font></strong> (a certain amount of computation) has been performed<ul>
<li>you pay for each computational unit so that miners get properly compensated</li>
</ul>
</li>
</ul>
<h4 id="Gas"><a href="#Gas" class="headerlink" title="Gas"></a><font color=deepskyblue>Gas</font></h4><blockquote>
<p>Ethereum: “<strong>pay-per-computational-step</strong>” model</p>
</blockquote>
<p>instead of pricing instructions directly in ETH (the price of which fluctuates), we use another metric: <strong><font color=red>GAS</font></strong></p>
<p>each <strong>EVM instruction</strong> has a predefined GAS cost that is independent of the value of ETH</p>
<p><strong>the gas cost of a transaction is the sum of the cost for each instruction executed</strong></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201109225608055.png" class="" title="INSTRUCTION GAS COSTS">
<blockquote>
<p>source: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/djrtwo/evm-opcode-gas-costs/blob/master/opcode-gas-costs_EIP-150_revision-1e18248_2017-04-12.csv">https://github.com/djrtwo/evm-opcode-gas-costs/blob/master/opcode-gas-costs_EIP-150_revision-1e18248_2017-04-12.csv</a></p>
</blockquote>
<h4 id="Gas-Limit"><a href="#Gas-Limit" class="headerlink" title="Gas Limit"></a><font color=aqua>Gas Limit</font></h4><p>when you send a transaction, you specify a <strong><font color=red>gas limit</font></strong>: <strong>the maximum amount of GAS you are willing to spend</strong></p>
<ul>
<li>if the execution reaches this limit before finishing, the transaction is reverted and you pay the corresponding fee</li>
<li>if the gas used by the execution is below the limit, the remaining gas is refunded to your account</li>
</ul>
<blockquote>
<p>this basically solves the halting problem: you can write infinite loops but you’ll have to pay for them</p>
</blockquote>
<h4 id="Gas-Price"><a href="#Gas-Price" class="headerlink" title="Gas Price"></a><font color=aqua>Gas Price</font></h4><p>when you send a transaction, you specify a <strong><font color=red>gas price</font></strong>: <strong>the amount of ETH you’re willing to pay per gas</strong></p>
<p>you are free to choose what gas price to set, similarly to Bitcoin where you can set the transaction fee freely</p>
<p>the miner is free to choose which transactions to include. it is likely to choose transactions with higher gas pric</p>
<blockquote>
<p>这里也会变成类似比特币的拍卖系统</p>
</blockquote>
<hr>
<p><strong>Example</strong>:</p>
<blockquote>
<p>Let’s say you can a transaction with</p>
<ul>
<li>gas limit: 50000</li>
<li>gas price: 0.00000008 Ether (80 Gwei)</li>
</ul>
<p>you will have to make an up-front(预付) payment of</p>
<ul>
<li>50000 x 0.00000008 = 0.004 ETH</li>
</ul>
<p>if execution uses 41172 gas, after refund you’ll effectively pay</p>
<ul>
<li>41172 x 0.00000008 = 0.00329376 ETH</li>
</ul>
</blockquote>
<h4 id="Example-Contract"><a href="#Example-Contract" class="headerlink" title="Example Contract"></a>Example Contract</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">contract Test &#123;</span><br><span class="line">    uint256 num_a = <span class="number">0</span>;</span><br><span class="line">    uint256 num_b = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    function <span class="title function_">increment</span><span class="params">()</span> public &#123;</span><br><span class="line">        num_a += <span class="number">1</span>;</span><br><span class="line">        num_b += <span class="number">1</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// incrementing is essentially equivalent to:</span></span><br><span class="line">        <span class="comment">// uint256 current_value = number;</span></span><br><span class="line">        <span class="comment">// uint256 new_value = current_value + 1;</span></span><br><span class="line">        <span class="comment">// number = new_value;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// solc compiles it like this:</span></span><br><span class="line">        <span class="comment">// SLOAD ADD SWAP3 POP POP DUP2 SWAP1 SSTORE POP PUSH1 0x1 DUP1</span></span><br><span class="line">        <span class="comment">// PUSH1 0x0 DUP3 DUP3 SLOAD ADD SWAP3 POP POP DUP2 SWAP1 SSTORE</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// we will simply treat it like this:</span></span><br><span class="line">        <span class="comment">// SLOAD ADD SSTORE SLOAD ADD SSTORE</span></span><br><span class="line">        <span class="comment">// gas cost: 2 x (3 + 200 + 5000) = 10406 GAS</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>what happens if we provide a gas limit of <strong>5203 GAS</strong>? (不足的GAS)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract Test &#123;</span><br><span class="line">    uint256 num_a = <span class="number">0</span>;</span><br><span class="line">    uint256 num_b = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">increment</span><span class="params">()</span> public &#123;</span><br><span class="line">        num_a += <span class="number">1</span>; <span class="comment">// this succeeds</span></span><br><span class="line">        			<span class="comment">// &lt;- we run out of gas at this point</span></span><br><span class="line">        num_b += <span class="number">1</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// the whole transaction is reverted</span></span><br><span class="line">        <span class="comment">// neither num_a nor num_b is updated</span></span><br><span class="line">        <span class="comment">// the sender pays for the executed 5203 GAS</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>what happens if we provide a gas limit of 12000 GAS? (足够的GAS)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract Test &#123;</span><br><span class="line">    uint256 num_a = <span class="number">0</span>;</span><br><span class="line">    uint256 num_b = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    function <span class="title function_">increment</span><span class="params">()</span> public &#123;</span><br><span class="line">        num_a += <span class="number">1</span>; <span class="comment">// this succeeds</span></span><br><span class="line">        num_b += <span class="number">1</span>; <span class="comment">// this also succeeds</span></span><br><span class="line">        			<span class="comment">// we finish the execution</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// the whole transaction succeeds</span></span><br><span class="line">        <span class="comment">// both num_a and num_b will be updated</span></span><br><span class="line">        <span class="comment">// the sender pays for the executed 10406 GAS, 1594 is refunded</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<hr>
<p><strong>Why call it “GAS”</strong>? （<em>Why the gas analogy(类比)?</em>）</p>
<ul>
<li>gasoline is what really moves your car, just as it moves the execution of smart contracts</li>
<li>your car’s gas consumption is roughly static, while the price of gasoline changes</li>
<li>you could try stuffing dollar bills into the fuel tank of your car, but instead you buy gasoline using dollars, and use that to run it</li>
</ul>
<h3 id="Conflux"><a href="#Conflux" class="headerlink" title="Conflux"></a>Conflux</h3><p>Conflux inherited the same fee mechanism from Ethereum, with <strong>a few changes</strong>:</p>
<ul>
<li>limited gas refund</li>
<li>separate payment for execution and storage</li>
<li>gas can be sponsored（代付机制）</li>
</ul>
<h4 id="Limited-Gas-Refund-有限回偿"><a href="#Limited-Gas-Refund-有限回偿" class="headerlink" title="Limited Gas Refund 有限回偿"></a>Limited Gas Refund 有限回偿</h4><p>the cost of a contract call might change, depending on when you call it. consider the following example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract MaybeExpensive &#123;</span><br><span class="line">    uint256 num = <span class="number">0</span>;</span><br><span class="line">    event <span class="title function_">E</span><span class="params">(uint8 n)</span>;</span><br><span class="line">    </span><br><span class="line">    function <span class="title function_">increment</span><span class="params">()</span> public &#123; num += <span class="number">1</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    function <span class="title function_">foo</span><span class="params">()</span> public &#123;</span><br><span class="line">        <span class="keyword">if</span> (num == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (uint8 ii = <span class="number">0</span>; ii &lt; <span class="number">1000</span>; ii++) &#123;</span><br><span class="line">                emit <span class="title function_">E</span><span class="params">(ii)</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>triggering foo() might do almost nothing, or it might also emit 1000 events, depending on the current value of num</p>
</blockquote>
<ul>
<li>in Conflux, miners cannot know for sure the state on whichthe transaction is executed<ul>
<li>this makes it <strong>impossible to accurately estimate the profits of including certain transactions</strong></li>
</ul>
</li>
<li>to make this estimation easier, <strong><font color=red>at most 1/4 of the whole gas is refunded</font></strong><ul>
<li>e.g. if gas limit is 10000 and the transaction execution used 6000 gas, the account will still be charged for 7500</li>
</ul>
</li>
</ul>
<p>这是对矿工收益的权衡之举。</p>
<h4 id="Pay-Separately-for-Storage-存储抵押费"><a href="#Pay-Separately-for-Storage-存储抵押费" class="headerlink" title="Pay Separately for Storage 存储抵押费"></a>Pay Separately for Storage 存储抵押费</h4><p><strong>in Ethereum paying for storage is a one-time fee</strong> (gas for SSTORE), even though <strong><font color=blue>miners might have to store it forever</font></strong>.</p>
<p>consider this example: that 13 has to be stored on each machine maintaining the blockchain.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">contract Storage &#123;</span><br><span class="line">    mapping (address =&gt; uint256) data;</span><br><span class="line">    constructor() &#123;</span><br><span class="line">    	data[msg.sender] = <span class="number">13</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>in Conflux, you need to deposit CFX for storage entries.<br>this deposit is called <strong>storage collateral</strong>.</p>
<blockquote>
<p>miners earn interest on the collateralized storage</p>
</blockquote>
<p>if someone deletes or overwrites your entry, you get back your collateral</p>
<hr>
<hr>
<hr>
<p>so what you will pay is</p>
<center><strong>(<i><font color=blue>gas_used</font></i> x <i><font color=blue>gas_price</font></i>) + (<i><font color=green>1/16 CFX</font></i> x <i><font color=green>storage_collateralized</font></i>)</strong></center>

<p>… minus the refund of at most <strong><i><font color=red>1/4</font></i> x <i><font color=red>gas_used</font></i> x <i><font color=red>gas_price</font></i></strong></p>
<h2 id="transaction-sponsorship"><a href="#transaction-sponsorship" class="headerlink" title="transaction sponsorship"></a>transaction sponsorship</h2><h3 id="The-Problem-with-Gas"><a href="#The-Problem-with-Gas" class="headerlink" title="The Problem with Gas"></a>The Problem with Gas</h3><p>Ethereum dapps: high entry barrier</p>
<ul>
<li>get a wallet, acquire some ETH, …</li>
</ul>
<p>are people willing to pay for each transaction?</p>
<ul>
<li>web 2.0: you have to pay for your server’s uptime but you don’t directly push this onto your customers; you have other revenue streams</li>
</ul>
<h3 id="Sponsorship-Mechanism-in-Conflux"><a href="#Sponsorship-Mechanism-in-Conflux" class="headerlink" title="Sponsorship Mechanism in Conflux"></a>Sponsorship Mechanism in Conflux</h3><p>某个人可以选择为某个智能合约的所有交易代付手续费。从而降低人们参与智能合约的门槛。</p>
<blockquote>
<p>someone can choose to sponsor transactions to a smart contract, i.e. pay on the sender’s behalf</p>
</blockquote>
<p>example use case: <strong>MoonSwap</strong></p>
<ul>
<li><strong>UniSwap</strong>: if you swap ETH for USDT, fees are around $4.1 at the time of writing</li>
<li><strong>MoonSwap</strong>: would cost $0.4 at current price but in practice it’s $0 because the transaction is sponsored</li>
</ul>
<h3 id="代付白名单控制"><a href="#代付白名单控制" class="headerlink" title="代付白名单控制"></a>代付白名单控制</h3><p>there is a <strong>built-in contract</strong>(魔术合约，系统内置，由Conflux提供) called <strong>SponsorWhitelistControl</strong><br>address: <strong><code>0x0888000000000000000000000000000000000001</code></strong></p>
<p>sponsor calls <code>setSponsorForGas(…)</code> to <strong>become the sponsor of a smart contract</strong>. they will also send some CFX along that will be used to cover the gas costs.</p>
<p>contract calls <code>addPrivilege(…)</code> to “whitelist” accounts<br>(or use 0x0000000000000000000000000000000000000000 (含义：为所有人代付) )</p>
<hr>
<p>let’s say Alice deploys the following contract for her dapp</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract MyCoolDapp &#123;</span><br><span class="line">    constructor() &#123;</span><br><span class="line">        address addr = <span class="number">0x0888000000000000000000000000000000000001</span>;  <span class="comment">// 白名单合约地址</span></span><br><span class="line">        SponsorWhitelistControl swc = SponsorWhitelistControl(addr);</span><br><span class="line">        </span><br><span class="line">        address[] memory a = new address[](<span class="number">1</span>);</span><br><span class="line">        a[<span class="number">0</span>] = <span class="number">0x0000000000000000000000000000000000000000</span>;  <span class="comment">// 代付所有人</span></span><br><span class="line">        swc.add_privilege(a);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function <span class="title function_">doSomething</span><span class="params">()</span> public &#123;</span><br><span class="line">    	<span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>when Bob calls <code>doSomething()</code> , he has to cover gas and storage</p>
</blockquote>
<p>at some point, Alice <strong>sends 10 CFX to the SWC contract</strong> through this call:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">swc.setSponsorForGas(</span><br><span class="line">    <span class="number">0x8caddbc9f0360b6b96e32fc0a37ffa275ee139f6</span>, <span class="comment">// contract</span></span><br><span class="line">    <span class="number">100000000000000000</span>, <span class="comment">// upper limit per transaction: 0.1 CFX</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<p>upper_bound is in Drip but transfer amount is in CFX</p>
</blockquote>
<p>she will most likely do this using the JavaScript SDK, or directly from Conflux Studio</p>
<p>this means that at least 100 transactions will be sponsored</p>
</blockquote>
<p>when Bob calls <code>doSomething()</code> again, he does not need to pay anymore</p>
<hr>
<h3 id="blockchain-applications-and-tools"><a href="#blockchain-applications-and-tools" class="headerlink" title="blockchain applications and tools"></a>blockchain applications and tools</h3><ul>
<li>通证 tokens (ERC-20货币通证, NFT非同质通证)<ul>
<li>stablecoin</li>
<li>tokenized art</li>
<li>tokenized real-world assets</li>
</ul>
</li>
<li>DeFi<ul>
<li>MoonDex 去中心化交易所</li>
<li>MoonSwap<ul>
<li>AMM（自动做市商）</li>
</ul>
</li>
</ul>
</li>
<li>ShuttleFlow 跨链映射协议<ul>
<li>a building block for DeFi applications</li>
<li>move tokens from other chains to Conflux</li>
<li>e.g. ETH -&gt; cETH, BTC -&gt; cBTC（资产的跨链转移）</li>
</ul>
</li>
<li>Oracles（预言机）<ul>
<li>allow your smart contract to interact with the world（安全地获取外界的信息）</li>
</ul>
</li>
</ul>
<hr>
<h3 id="Resources-1"><a href="#Resources-1" class="headerlink" title="Resources"></a>Resources</h3><ul>
<li>ETH Gas Station<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://ethgasstation.info">https://ethgasstation.info</a></li>
</ul>
</li>
<li>Bitcoin’s Underlying Incentives<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://queue.acm.org/detail.cfm?id=3168362">https://queue.acm.org/detail.cfm?id=3168362</a></li>
</ul>
</li>
<li>Zohar et al. Redesigning bitcoin’s fee market. 2019.<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://arxiv.org/abs/1709.08881">https://arxiv.org/abs/1709.08881</a></li>
</ul>
</li>
<li>Eyal, Sirer. Majority is not Enough: Bitcoin Mining is Vulnerable.<br>2013.<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cs.cornell.edu/~ie53/publications/btcProcFC.pdf">https://www.cs.cornell.edu/~ie53/publications/btcProcFC.pdf</a></li>
</ul>
</li>
<li>What is Ethereum Gas?<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blockgeeks.com/guides/ethereum-gas">https://blockgeeks.com/guides/ethereum-gas</a></li>
</ul>
</li>
<li>Staking &amp; Collateral For Storage On Conflux Network<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.com/conflux-network/conflux-economic-model-staking-collateral-for-storage-on-conflux-network-cb4c8c150e3">https://medium.com/conflux-network/conflux-economic-model-staking-collateral-for-storage-on-conflux-network-cb4c8c150e3</a></li>
</ul>
</li>
<li>Block Reward Components Under the Network’s Mining Incentive Model<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.com/conflux-network/conflux-networks-economic-model-block-reward-components-under-the-network-s-mining-incentive-ceadd8f8408f">https://medium.com/conflux-network/conflux-networks-economic-model-block-reward-components-under-the-network-s-mining-incentive-ceadd8f8408f</a></li>
</ul>
</li>
</ul>
<h1 id="Homework-of-Lecture-6"><a href="#Homework-of-Lecture-6" class="headerlink" title="Homework of Lecture 6"></a>Homework of Lecture 6</h1><blockquote>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.conflux.fun/t/topic/3741">Lecture 6 - Homework &amp; Resources</a></p>
<blockquote>
<p>Homework is done by a group.</p>
</blockquote>
</blockquote>
<h2 id="1-Answer-the-following-questions-in-a-few-sentences-using-your-own-words"><a href="#1-Answer-the-following-questions-in-a-few-sentences-using-your-own-words" class="headerlink" title="1. Answer the following questions in a few sentences using your own words."></a>1. Answer the following questions in a few sentences using your own words.</h2><p>1.a) Why does Ethereum price EVM instructions in GAS instead of using ETH directly?</p>
<blockquote>
<p><em>GAS refers to the computational power required from miners to validate the transaction or smart contract. ETH is the currency used to compensate miners for the GAS required to do the computational work. GAS consumption values are relatively static, while the price of ETH is dynamic and changes overtime.</em> </p>
<p><em>Charging instructions in GAS thus makes it easier for miners to measure the <strong>cost-benefits of a computation</strong></em> <em>and planning their work.</em></p>
</blockquote>
<p>1.b) What is the goal of the gas sponsorship mechanism introduced in Conflux?</p>
<blockquote>
<p><em>Transactions costs on the blockchain are traditionally paid by the user, who benefits from the blockchain network feature.</em> </p>
<p><em>However, as with the case in any other economy, costs are always</em> <strong><em>pain points</em></strong> <em>and discourages adoption. Adoption is critical for building an ecosystem which value increases from network externalities, which precisely the case with most blockchain networks. In addition,</em> <strong><em>blockchain is not necessarily used to facilitate transactions</em></strong>, <em>so there is the possibility that users of the network do not have any deposited amount with which to pay the transaction fee.</em></p>
<p><em>The gas sponsorship mechanism therefore 1) removes a barrier to adoption of the network by new users and 2) increases the application scenarios / flexibility of the smart contract.</em></p>
</blockquote>
<p>1.c) What steps should a developer take so that users of their smart contract do not have to pay for gas?</p>
<blockquote>
<p><em>Implement the Gas Sponsorship Mechanism: allow anyone willing to pay to become a “Sponsor”, donating funds to any contract to pay for the transactions of other whitelisted users (usually new ones with 0 account balance).</em></p>
<p><em>Several parameters to include:</em></p>
<ol>
<li><em>Sponsor - records the account providing sponsorship funds for the smart contract</em></li>
<li><em>Sponsor balance - records the current balance of the sponsorship funds for the smart contract</em></li>
<li><em>Sponsor limit per transaction - sets an upper limit of funds for individual transactions</em></li>
<li><em>Whitelist - records, or limits, the accounts that can be sponsored/funded by the smart contract</em></li>
</ol>
</blockquote>
<h2 id="1-Gas-cost-of-token-transfers-OPTIONAL"><a href="#1-Gas-cost-of-token-transfers-OPTIONAL" class="headerlink" title="+1. Gas cost of token transfers [OPTIONAL]"></a>+1. Gas cost of token transfers [OPTIONAL]</h2><p>Download lecture-5’s CourseToken project (<a target="_blank" rel="noopener external nofollow noreferrer" href="http://github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-5.zip">github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-5.zip 2</a>) or use your own version.</p>
<p>Send some tokens to a new address. How much were you charged for this transfer? Try to explain why.</p>
<p>How does the fee change if you send some more tokens to the same address again?</p>
<blockquote>
<p>Create a new “CourseCoin” contract:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110221640108.png" class="" title="create">
<p><strong>Send some tokens to a new address</strong>:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110223816308.png" class="" title="sending tests">
<ul>
<li><strong>How much were you charged for this transfer?</strong><ul>
<li>sent <code>10</code>, “gasUsed”: “<strong><font color=red>35819</font></strong>“ with gas limit “1000000”, and “gasPrice”: 100</li>
<li><del>Before Vel has CFX: <strong><code>34363.0111445711547907 CFX</code></strong></del><ul>
<li><del>SUDDENLY I realize that “Vel” is mining to gain more CFXs. So it won’t work this way.</del></li>
</ul>
</li>
<li>Created another new “CourseCoin” contract with “Calvin”<ul>
<li>Before Calvin has CFX: <strong><code>9997.756835937425</code> CFX</strong></li>
<li>After Calvin has CFX:    <strong><code>9997.69433593735</code> CFX</strong></li>
<li>So, total cost is: <strong><code>0.06250000007457857</code> CFX</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Try to explain why.</strong></p>
<p>We have the calculation form for this as follows:</p>
<blockquote>
<p><em>so what you will pay is</em></p>
<center><strong>(<i><font color=blue>gas_used</font></i> x <i><font color=blue>gas_price</font></i>) + (<i><font color=green>1/16 CFX</font></i> x <i><font color=green>storage_collateralized</font></i>)</strong></center>

<p><em>… minus the refund of at mos</em>t <strong><i><font color=red>1/4</font></i> x <i><font color=red>gas_used</font></i> x <i><font color=red>gas_price</font></i></strong></p>
</blockquote>
<ul>
<li><i><font color=blue>gas_used</font></i> x <i><font color=blue>gas_price</font></i> = <code>35819 * 100</code> = 3581900 Drips = 3.5819e-12 CFX (<strong>In theory</strong>)<ul>
<li>But according to the refund policy:<ul>
<li><i><font color=blue>gas_used</font></i> x <i><font color=blue>gas_price</font></i> = <code>3/4 * 1000000 * 100</code> = 75000000 Drips = 7.5e-11 CFX</li>
</ul>
</li>
</ul>
</li>
<li>so we can deduce that:<ul>
<li><i><font color=green>1/16 CFX</font></i> x <i><font color=green>storage_collateralized</font></i> =  <strong><code>0.06250000007457857</code> CFX</strong> - 7.5e-11 CFX $\approx$ 0.0625 CFX</li>
<li>which also implies: <i><font color=green>storage_collateralized</font></i>  $\approx$ 1</li>
</ul>
</li>
</ul>
<blockquote>
<p>But still, the numbers doesn’t exactly match which is still remaining mystery.</p>
</blockquote>
<p><strong>How does the fee change if you send some more tokens to the same address again?</strong></p>
<ul>
<li>sent <code>1234</code>, gasUsed”: “<strong><font color=red>35883</font></strong>“</li>
<li>Calvin now has CFX:   <strong><code>9997.694335937275</code> CFX</strong></li>
<li>total cost is: <strong><code>0.000000000075</code> CFX</strong></li>
<li>It becomes <strong>significantly low</strong>. I think it’s because the first transaction include data storage initialization which is expensive (<strong><i><font color=green>1/16 CFX</font></i> x <i><font color=green>storage_collateralized</font></i></strong>).</li>
</ul>
</blockquote>
<h2 id="1-Sponsored-ticket-sale-OPTIONAL"><a href="#1-Sponsored-ticket-sale-OPTIONAL" class="headerlink" title="+1. Sponsored ticket sale [OPTIONAL]"></a>+1. Sponsored ticket sale [OPTIONAL]</h2><p>Download lecture-4’s Tickets project (<a target="_blank" rel="noopener external nofollow noreferrer" href="http://github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-4-tickets.zip">github.com/Thegaram/cfx-uma-resources/raw/master/cfx-lecture-4-tickets.zip</a>) or use your own version.</p>
<p>Change the contract so that people buying tickets through it <strong>do not have to pay any transaction fee</strong>.</p>
<blockquote>
<p>First, trying to find <code>SponsorWhitelistControl.sol</code>.</p>
<blockquote>
<p>The <code>import &quot;github.com/Conflux-Chain/conflux-rust/blob/master/internal_contract/contracts/SponsorWhitelistControl.sol&quot;;</code> doesn’t seem working now. Bad news.</p>
</blockquote>
<p>But going the website and copying the code is avaliable. And the version is changed. Function Callings are also different.</p>
<p>So I reimplement the <code>SponsorWhitelistControl.sol</code> to fit the demand.</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110233817335.png" class="" title="reimplement">
<p>Now we deploy the ticket contract, and there are few changes in the code:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110233941247.png" class="" title="changes">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234019028.png" class="" title="deploy">
<blockquote>
<p>The ticket is priced as 15 CFX for each.</p>
</blockquote>
<p>“Leon” has 10000 CFX at first:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234106465.png" class="" title="Leon balance">
<p>Leon buys 1 ticket:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234242002.png" class="" title="Leon balance">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234301936.png" class="" title="buy">
<p>Let’s say Jessica wants to sponsor the contract:</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201110234445503.png" class="" title="Jessica">
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111001414466.png" class="" title="sponsor">
<p>running into a serious trouble…</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111001212392.png" class="" title="failed">
<p>All the sponsor transactions are timeout and reverted, even the ones I directly send from the <code>0x0888000000000000000000000000000000000001</code> panel.</p>
<p>After some parameter adjustments, it worked.</p>
<p><strong>Calvin sponsored 101 CFX to the contract.</strong></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111181900247.png" class="" title="Calvin">
<p>Now we can try to buy some more tickets without any charges:</p>
<p>Leon has: <strong>9974.81249999985 CFX</strong></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111182622153.png" class="" title="Leon balance">
<p>Leon buys 2 tickets: (Each ticket is 5 CFX)</p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111182715084.png" class="" title="buy">
<p>Leon has: 9974.81249999985 CFX - 10 CFX =  <strong>9964.81249999985 CFX</strong></p>
<img data-src="/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/image-20201111182857195.png" class="" title="Leon balance">
<p>Indeed there is no transaction fee for Leon! We made it!</p>
</blockquote>
<h1 id="Lecture-7-DeFi-Reconstruction-and-Innovation-of-Finance"><a href="#Lecture-7-DeFi-Reconstruction-and-Innovation-of-Finance" class="headerlink" title="Lecture 7 - DeFi, Reconstruction and Innovation of Finance"></a>Lecture 7 - DeFi, Reconstruction and Innovation of Finance</h1><h1 id="Lecture-8-Blockchain-Story"><a href="#Lecture-8-Blockchain-Story" class="headerlink" title="Lecture 8 - Blockchain Story"></a>Lecture 8 - Blockchain Story</h1><h1 id="Final-Project"><a href="#Final-Project" class="headerlink" title="Final Project"></a>Final Project</h1><blockquote>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/stellarkey/uma_bbnc_project">https://github.com/stellarkey/uma_bbnc_project</a></p>
</blockquote>
<div><hr><font size=5>相关文章</font><ul><li><a href="https://stellarkey.github.io/%E6%8C%96%E7%9F%BF%E5%85%A5%E9%97%A8/">挖矿入门</a></li><li><a href="https://stellarkey.github.io/%E5%8C%BA%E5%9D%97%E9%93%BE%E8%AF%BE%E7%A8%8B%E5%AE%9E%E9%AA%8C/">区块链课程实验</a></li><li><a href="https://stellarkey.github.io/%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E%E7%AE%80%E8%AE%B0/">零知识证明简记</a></li></ul></div>
    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>工云
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/" title="北斗UMA专项">https://stellarkey.github.io/北斗UMA专项/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag"><i class="fa fa-tag"></i> 区块链</a>
              <a href="/tags/Conflux/" rel="tag"><i class="fa fa-tag"></i> Conflux</a>
          </div>

        
  <div class="post-widgets">
    <div class="wp_rating">
      <div id="wpac-rating"></div>
    </div>
  </div>


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/%E4%B8%AD%E8%8D%AF%E8%AF%B4%E6%98%8E%E4%B9%A6%E5%AE%9E%E4%BD%93%E8%AF%86%E5%88%AB%E6%8C%91%E6%88%98%E7%BA%AA%E8%A6%81/" rel="prev" title="中药说明书实体识别挑战纪要">
      <i class="fa fa-chevron-left"></i> 中药说明书实体识别挑战纪要
    </a></div>
      <div class="post-nav-item">
    <a href="/%E5%90%89%E4%BB%96%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0/" rel="next" title="吉他进阶">
      吉他进阶 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#References"><span class="nav-number">1.</span> <span class="nav-text">References</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lecture-1-Introduction-Of-Blockchain"><span class="nav-number">2.</span> <span class="nav-text">Lecture 1 - Introduction Of Blockchain</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lecture-2-Cryptoeconomics-%E5%8A%A0%E5%AF%86%E7%BB%8F%E6%B5%8E%E5%AD%A6"><span class="nav-number">3.</span> <span class="nav-text">Lecture 2 - Cryptoeconomics 加密经济学</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Token-%E9%80%9A%E8%AF%81"><span class="nav-number">3.1.</span> <span class="nav-text">Token 通证</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Token-Design"><span class="nav-number">3.1.1.</span> <span class="nav-text">Token Design</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-D%E2%80%99s-of-Token-Design"><span class="nav-number">3.1.2.</span> <span class="nav-text">3 D’s of Token Design</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conflux-Token-Economy-%E9%80%9A%E8%AF%81%E7%BB%8F%E6%B5%8E"><span class="nav-number">3.2.</span> <span class="nav-text">Conflux Token Economy 通证经济</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-problem"><span class="nav-number">3.2.1.</span> <span class="nav-text">Key problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Conflux-Token-CFX"><span class="nav-number">3.2.2.</span> <span class="nav-text">Conflux Token (CFX)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Staking-%E6%9D%83%E7%9B%8A%E5%88%B6"><span class="nav-number">3.2.3.</span> <span class="nav-text">Staking 权益制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Staking-for-Interest-%E5%88%A9%E6%81%AF"><span class="nav-number">3.2.3.1.</span> <span class="nav-text">Staking for Interest 利息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Staking-for-Storage-Space-%E5%AD%98%E5%82%A8"><span class="nav-number">3.2.3.2.</span> <span class="nav-text">Staking for Storage Space 存储</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Staking-for-Voting-Rights-%E6%8A%95%E7%A5%A8%E6%9D%83"><span class="nav-number">3.2.3.3.</span> <span class="nav-text">Staking for Voting Rights 投票权</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mining-Rewards-%E6%8C%96%E7%9F%BF%E5%A5%96%E5%8A%B1"><span class="nav-number">3.2.4.</span> <span class="nav-text">Mining Rewards 挖矿奖励</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Economy-System"><span class="nav-number">3.2.5.</span> <span class="nav-text">Economy System</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lecture-3-Fundamental-Concepts-amp-Tools"><span class="nav-number">4.</span> <span class="nav-text">Lecture 3 - Fundamental Concepts &amp; Tools</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Resources"><span class="nav-number">4.1.</span> <span class="nav-text">Resources</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Accounts-amp-Transactions-%E8%B4%A6%E6%88%B7%E5%92%8C%E4%BA%A4%E6%98%93"><span class="nav-number">4.2.</span> <span class="nav-text">Accounts &amp; Transactions 账户和交易</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Digital-signatures-%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D"><span class="nav-number">4.2.1.</span> <span class="nav-text">Digital signatures 数字签名</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Wallets"><span class="nav-number">4.2.1.1.</span> <span class="nav-text">Wallets</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#js-conflux-sdk"><span class="nav-number">4.2.2.</span> <span class="nav-text">js-conflux-sdk</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-amp-Address-Coding-practice"><span class="nav-number">4.2.3.</span> <span class="nav-text">Key &amp; Address - Coding practice</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sign-a-message-using-our-private-key"><span class="nav-number">4.2.3.1.</span> <span class="nav-text">sign a message using our private key</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#check-message-authenticity"><span class="nav-number">4.2.3.2.</span> <span class="nav-text">check message authenticity</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tamper-with-message"><span class="nav-number">4.2.3.3.</span> <span class="nav-text">tamper with message</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#full-example"><span class="nav-number">4.2.3.4.</span> <span class="nav-text">full example</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Account"><span class="nav-number">4.2.4.</span> <span class="nav-text">Account</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Transaction"><span class="nav-number">4.2.5.</span> <span class="nav-text">Transaction</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Distributed-ledger-%E5%88%86%E5%B8%83%E5%BC%8F%E8%B4%A6%E6%9C%AC"><span class="nav-number">4.3.</span> <span class="nav-text">Distributed ledger 分布式账本</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Block-%E5%8C%BA%E5%9D%97"><span class="nav-number">4.3.1.</span> <span class="nav-text">Block 区块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Blockchain"><span class="nav-number">4.3.2.</span> <span class="nav-text">Blockchain</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tree-graph"><span class="nav-number">4.3.3.</span> <span class="nav-text">Tree-graph</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#THE-LEDGER-OF-CONFLUX-%E2%80%94-FURTHER-READING"><span class="nav-number">4.3.4.</span> <span class="nav-text">THE LEDGER OF CONFLUX — FURTHER READING</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Smart-contracts-%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="nav-number">4.4.</span> <span class="nav-text">Smart contracts 智能合约</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#transaction-receipt-%E4%BA%A4%E6%98%93%E6%94%B6%E6%8D%AE"><span class="nav-number">4.4.1.</span> <span class="nav-text">transaction receipt 交易收据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Inspect-data-on-the-ledger"><span class="nav-number">4.5.</span> <span class="nav-text">Inspect data on the ledger</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Conflux-Scan-Blockchain-Explorers"><span class="nav-number">4.5.1.</span> <span class="nav-text">Conflux Scan(Blockchain Explorers)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Set-up-wallet-amp-Send-transactions"><span class="nav-number">4.6.</span> <span class="nav-text">Set up wallet &amp; Send transactions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#wallet%E2%80%99s-usage"><span class="nav-number">4.6.1.</span> <span class="nav-text">wallet’s usage</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Conflux-Portal-Wallet"><span class="nav-number">4.6.2.</span> <span class="nav-text">Conflux Portal(Wallet)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Create-a-wallet"><span class="nav-number">4.6.2.1.</span> <span class="nav-text">Create a wallet</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Wallet-Security-101"><span class="nav-number">4.6.3.</span> <span class="nav-text">Wallet Security 101</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-to-acquire-tokens"><span class="nav-number">4.6.4.</span> <span class="nav-text">How to acquire tokens?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Interact-with-dapps-%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96%E5%BA%94%E7%94%A8"><span class="nav-number">4.7.</span> <span class="nav-text">Interact with dapps(去中心化应用)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Homework-of-Lecture-3"><span class="nav-number">5.</span> <span class="nav-text">Homework of Lecture 3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#transaction-classification"><span class="nav-number">5.1.</span> <span class="nav-text">transaction classification</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#block-match-search"><span class="nav-number">5.2.</span> <span class="nav-text">block match search</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#failed-transaction"><span class="nav-number">5.3.</span> <span class="nav-text">failed transaction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CFX-faucet-test"><span class="nav-number">5.4.</span> <span class="nav-text">CFX faucet test</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#buy-a-ticket"><span class="nav-number">5.5.</span> <span class="nav-text">buy a ticket</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#query-ticket-purchases"><span class="nav-number">5.5.1.</span> <span class="nav-text">query ticket purchases</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#creator-of-the-Tickets-contract"><span class="nav-number">5.5.2.</span> <span class="nav-text">creator of the Tickets contract</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#balance-of-this-account"><span class="nav-number">5.5.2.1.</span> <span class="nav-text">balance of this account</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#the-most-FC-tokens-address"><span class="nav-number">5.6.</span> <span class="nav-text">the most FC tokens address</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lecture-4-Introduction-to-Smart-Contracts"><span class="nav-number">6.</span> <span class="nav-text">Lecture 4 - Introduction to Smart Contracts</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Decentralized-Applications-Architecture"><span class="nav-number">6.1.</span> <span class="nav-text">Decentralized Applications Architecture</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Traditional-Web-Applications-Web-2-0"><span class="nav-number">6.1.1.</span> <span class="nav-text">Traditional Web Applications (Web 2.0)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Decentalized-Applications-Web-3-0"><span class="nav-number">6.1.2.</span> <span class="nav-text">Decentalized Applications (Web 3.0)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conflux-Studio-Overview"><span class="nav-number">6.2.</span> <span class="nav-text">Conflux Studio Overview</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Toolchain"><span class="nav-number">6.2.1.</span> <span class="nav-text">Toolchain</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Basic-Usage"><span class="nav-number">6.2.2.</span> <span class="nav-text">Basic Usage</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Writing-Smart-Contracts"><span class="nav-number">6.3.</span> <span class="nav-text">Writing Smart Contracts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tockets-sol"><span class="nav-number">6.4.</span> <span class="nav-text">Tockets.sol</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Homework-of-Lecture-4"><span class="nav-number">7.</span> <span class="nav-text">Homework of Lecture 4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Conflux-Studio"><span class="nav-number">7.1.</span> <span class="nav-text">Conflux Studio</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tickets-sol"><span class="nav-number">7.2.</span> <span class="nav-text">Tickets.sol</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Buy-tickets"><span class="nav-number">7.2.1.</span> <span class="nav-text">Buy tickets</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Time-of-the-event"><span class="nav-number">7.2.2.</span> <span class="nav-text">Time of the event</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lecture-5-Introduction-to-Smart-Contracts-II"><span class="nav-number">8.</span> <span class="nav-text">Lecture 5 - Introduction to Smart Contracts II</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#minting-burning-logic"><span class="nav-number">8.1.</span> <span class="nav-text">minting &#x2F; burning logic</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TimeLockedTransfer"><span class="nav-number">8.2.</span> <span class="nav-text">TimeLockedTransfer</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Homework-of-Lecture-5"><span class="nav-number">9.</span> <span class="nav-text">Homework of Lecture 5</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-Understanding-the-lecture"><span class="nav-number">9.1.</span> <span class="nav-text">3.1 Understanding the lecture</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Trying-the-lecture-code"><span class="nav-number">9.2.</span> <span class="nav-text">3.2 Trying the lecture code</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Transfer-Factory-OPTIONAL"><span class="nav-number">9.3.</span> <span class="nav-text">+1. Transfer Factory [OPTIONAL]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Cancel-transfer-OPTIONAL"><span class="nav-number">9.4.</span> <span class="nav-text">+1. Cancel transfer [OPTIONAL]</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lecture-6-Gas-and-Gas-Sponsorship"><span class="nav-number">10.</span> <span class="nav-text">Lecture 6 - Gas and Gas Sponsorship</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#transaction-fee-%E4%BA%A4%E6%98%93%E8%B4%B9"><span class="nav-number">10.1.</span> <span class="nav-text">transaction fee 交易费</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Bitcoin-%E6%AF%94%E7%89%B9%E5%B8%81"><span class="nav-number">10.1.1.</span> <span class="nav-text">Bitcoin 比特币</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Miner-Income-%E7%9F%BF%E5%B7%A5%E6%94%B6%E7%9B%8A"><span class="nav-number">10.1.1.1.</span> <span class="nav-text">Miner Income 矿工收益</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Incentive-Alignment-%E6%BF%80%E5%8A%B1%E6%8E%AA%E6%96%BD"><span class="nav-number">10.1.1.2.</span> <span class="nav-text">Incentive Alignment 激励措施</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#transaction-fee-as-an-auction-%E6%8B%8D%E5%8D%96"><span class="nav-number">10.1.1.3.</span> <span class="nav-text">transaction fee as an auction 拍卖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bitcoin%E6%9C%BA%E5%88%B6%E4%B8%AD%E7%9A%84%E6%BC%8F%E6%B4%9E"><span class="nav-number">10.1.1.4.</span> <span class="nav-text">Bitcoin机制中的漏洞</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ethereum-%E4%BB%A5%E5%A4%AA%E5%9D%8A"><span class="nav-number">10.1.2.</span> <span class="nav-text">Ethereum 以太坊</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Halting-Problem-%E5%81%9C%E6%9C%BA%E9%97%AE%E9%A2%98"><span class="nav-number">10.1.2.1.</span> <span class="nav-text">Halting Problem 停机问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gas"><span class="nav-number">10.1.2.2.</span> <span class="nav-text">Gas</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gas-Limit"><span class="nav-number">10.1.2.3.</span> <span class="nav-text">Gas Limit</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gas-Price"><span class="nav-number">10.1.2.4.</span> <span class="nav-text">Gas Price</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Example-Contract"><span class="nav-number">10.1.2.5.</span> <span class="nav-text">Example Contract</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Conflux"><span class="nav-number">10.1.3.</span> <span class="nav-text">Conflux</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Limited-Gas-Refund-%E6%9C%89%E9%99%90%E5%9B%9E%E5%81%BF"><span class="nav-number">10.1.3.1.</span> <span class="nav-text">Limited Gas Refund 有限回偿</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pay-Separately-for-Storage-%E5%AD%98%E5%82%A8%E6%8A%B5%E6%8A%BC%E8%B4%B9"><span class="nav-number">10.1.3.2.</span> <span class="nav-text">Pay Separately for Storage 存储抵押费</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#transaction-sponsorship"><span class="nav-number">10.2.</span> <span class="nav-text">transaction sponsorship</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-with-Gas"><span class="nav-number">10.2.1.</span> <span class="nav-text">The Problem with Gas</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sponsorship-Mechanism-in-Conflux"><span class="nav-number">10.2.2.</span> <span class="nav-text">Sponsorship Mechanism in Conflux</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E4%BB%98%E7%99%BD%E5%90%8D%E5%8D%95%E6%8E%A7%E5%88%B6"><span class="nav-number">10.2.3.</span> <span class="nav-text">代付白名单控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#blockchain-applications-and-tools"><span class="nav-number">10.2.4.</span> <span class="nav-text">blockchain applications and tools</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Resources-1"><span class="nav-number">10.2.5.</span> <span class="nav-text">Resources</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Homework-of-Lecture-6"><span class="nav-number">11.</span> <span class="nav-text">Homework of Lecture 6</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Answer-the-following-questions-in-a-few-sentences-using-your-own-words"><span class="nav-number">11.1.</span> <span class="nav-text">1. Answer the following questions in a few sentences using your own words.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Gas-cost-of-token-transfers-OPTIONAL"><span class="nav-number">11.2.</span> <span class="nav-text">+1. Gas cost of token transfers [OPTIONAL]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Sponsored-ticket-sale-OPTIONAL"><span class="nav-number">11.3.</span> <span class="nav-text">+1. Sponsored ticket sale [OPTIONAL]</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lecture-7-DeFi-Reconstruction-and-Innovation-of-Finance"><span class="nav-number">12.</span> <span class="nav-text">Lecture 7 - DeFi, Reconstruction and Innovation of Finance</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lecture-8-Blockchain-Story"><span class="nav-number">13.</span> <span class="nav-text">Lecture 8 - Blockchain Story</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Final-Project"><span class="nav-number">14.</span> <span class="nav-text">Final Project</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="工云"
      src="/images/stellarkey.gif">
  <p class="site-author-name" itemprop="name">工云</p>
  <div class="site-description" itemprop="description">Never stop thinking.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">64</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://vel.life/" title="Life → https:&#x2F;&#x2F;vel.life&#x2F;" rel="noopener external nofollow noreferrer" target="_blank"><i class="fas fa-star-of-life fa-fw"></i>Life</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://vel.wiki/" title="Wiki → https:&#x2F;&#x2F;vel.wiki&#x2F;" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-wikipedia-w fa-fw"></i>Wiki</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/stellarkey" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;stellarkey" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:velocfc@gmail.com" title="E-Mail → mailto:velocfc@gmail.com" rel="noopener external nofollow noreferrer" target="_blank"><i class="fas fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/huo-shu-93/" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;huo-shu-93&#x2F;" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/18738090/" title="B站 → https:&#x2F;&#x2F;space.bilibili.com&#x2F;18738090&#x2F;" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-bilibili fa-fw"></i>B站</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener external nofollow noreferrer" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      云海之上
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.iszy.cc/" title="https:&#x2F;&#x2F;www.iszy.cc&#x2F;" rel="noopener external nofollow noreferrer" target="_blank">随遇而安</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://asdfv1929.github.io/" title="https:&#x2F;&#x2F;asdfv1929.github.io&#x2F;" rel="noopener external nofollow noreferrer" target="_blank">asdfv1929</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://printempw.github.io/" title="https:&#x2F;&#x2F;printempw.github.io&#x2F;" rel="noopener external nofollow noreferrer" target="_blank">PRIN BLOG</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.cfzhao.com/" title="http:&#x2F;&#x2F;www.cfzhao.com&#x2F;" rel="noopener external nofollow noreferrer" target="_blank">ZHAOYUWEI</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://hanherbert.github.io/" title="https:&#x2F;&#x2F;hanherbert.github.io&#x2F;" rel="noopener external nofollow noreferrer" target="_blank">知青</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://louieworth.github.io/" title="https:&#x2F;&#x2F;louieworth.github.io&#x2F;" rel="noopener external nofollow noreferrer" target="_blank">louieworth</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://hgen27.github.io/" title="https:&#x2F;&#x2F;hgen27.github.io&#x2F;" rel="noopener external nofollow noreferrer" target="_blank">Hgen</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-chart-line"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Vel</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">546k</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.14.0/lozad.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  



  <script>
  if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id    : 27281,
      el    : 'wpac-rating',
      color : 'fc6423'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }
  </script>

  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/3.0.5/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
  <script src="//unpkg.com/quicklink@2.2.0/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://stellarkey.github.io/%E5%8C%97%E6%96%97UMA%E4%B8%93%E9%A1%B9/',]
      });
      });
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
